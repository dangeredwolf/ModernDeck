/*!
 * ModernDeck 10.0.0, built 2022-06-12T01:24:02.304Z
 *
 * (c) 2014-2022 dangered wolf, released under MIT license.
 *
 * Made with <3
 *
 */(()=>{"use strict";var __webpack_require__={d:(exports,definition)=>{for(var key in definition)__webpack_require__.o(definition,key)&&!__webpack_require__.o(exports,key)&&Object.defineProperty(exports,key,{enumerable:!0,get:definition[key]})},o:(obj,prop)=>Object.prototype.hasOwnProperty.call(obj,prop)};__webpack_require__.d({},{WI:()=>main_autoUpdater,mX:()=>desktopConfig,ry:()=>mtdSchemeHandler});var HostManager=function(){function HostManager(){}return HostManager.mainWindow=null,HostManager.errorWindow=null,HostManager.loginWindow=null,HostManager.tray=null,HostManager.shouldQuitIfErrorClosed=!1,HostManager.closeForReal=!1,HostManager.mainWindowHidden=!1,HostManager.enableTray=!0,HostManager.enableBackground=!0,HostManager.isRestarting=!1,HostManager}(),store=new(require("electron-store"))({name:"mtdsettings"}),separator="win32"===process.platform?"\\":"/",isAppX=!!process.windowsStore,isFlatpak="linux"===process.platform&&"1"===process.env.FLATPAK_HOST,isMAS=!!process.mas,https=require("https"),fs=require("fs"),dialog=require("electron").dialog;var app=require("electron").app,mtdAppTag="";function updateAppTag(){var _a,_b,_c,_d;null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b||_b.executeJavaScript('document.querySelector("html").classList.remove("mtd-app");\t\tdocument.querySelector("html").classList.remove("mtd-app-win");\t\tdocument.querySelector("html").classList.remove("mtd-app-mac");\t\tdocument.querySelector("html").classList.remove("mtd-app-linux");\t'),mtdAppTag='document.querySelector("html").classList.add("mtd-js-app");\n',isAppX&&(mtdAppTag+='document.querySelector("html").classList.add("mtd-winstore");\n'),isFlatpak&&(mtdAppTag+='document.querySelector("html").classList.add("mtd-flatpak");\n'),isMAS&&(mtdAppTag+='document.querySelector("html").classList.add("mtd-macappstore");\n'),app.isEmojiPanelSupported()&&(mtdAppTag+='document.querySelector("html").classList.add("mtd-supportsNativeEmojiPicker");\n'),store.get("mtd_nativetitlebar")||(mtdAppTag+='document.querySelector("html").classList.add("mtd-app");\n',"darwin"===process.platform&&(mtdAppTag+='document.querySelector("html").classList.add("mtd-app-mac");\n'),"linux"===process.platform&&(mtdAppTag+='document.querySelector("html").classList.add("mtd-app-linux");\n'),"win32"===process.platform&&(mtdAppTag+='document.querySelector("html").classList.add("mtd-app-win");\n')),null===(_d=null===(_c=HostManager.mainWindow)||void 0===_c?void 0:_c.webContents)||void 0===_d||_d.executeJavaScript(store.get("mtd_fullscreen")?'document.querySelector("html").classList.add("mtd-js-app");':mtdAppTag)}var errorWindow,electron=require("electron"),errorWindow_app=electron.app,BrowserWindow=electron.BrowserWindow,shell=electron.shell;const i18nMain={"Check for Updates...":{zh_CN:"检查更新...",zh_TW:"檢查更新…",da:"Tjek for opdateringer...",en_CA:"Check for Updates...",en_GB:"Check for Updates...",en_US:"Check for Updates...",et:"Otsi värskendusi...",fr:"Rechercher des mises à jour...",fr_CA:"Rechercher des mises à jour...",de:"Nach Updates suchen...",hu:"Frissítés keresése...",it:"Controlla gli Aggiornamenti...",ja:"アップデートを確認する",ko:"업데이트 확인...",no:"Se etter oppdateringer...",pl:"Sprawdź aktualizacje...",pt:"Verificar se há atualizações...",ru:"Проверить обновления...",es:"Buscar Actualizaciones...",es_AR:"Buscar Actualizaciones...",es_419:"Buscar Actualizaciones...",es_US:"Buscar Actualizaciones...",uk:"Перевірити оновлення...",si:"යාවත්කාලීනයන් සඳහා පිරික්සන්න",sl:"Preveri za posodobitve...",id:"Periksa Pembaruan..."},"Preferences...":{zh_CN:"首选项",zh_TW:"偏好設定…",da:"Indstillinger...",en_CA:"Preferences...",en_GB:"Preferences...",en_US:"Preferences...",et:"Eelistused...",fr:"Paramètres...",fr_CA:"Paramètres...",de:"Einstellungen...",hu:"Beállítások...",it:"Preferenze...",ja:"設定",ko:"설정...",no:"Innstillinger...",pl:"Preferencje...",pt:"Preferências...",ru:"Настройки...",es:"Preferencias...",es_AR:"Preferencias...",es_419:"Preferencias...",es_US:"Preferencias...",uk:"Налаштування...",sl:"&Nastavitve...",id:"Pilihan..."},"Accounts...":{zh_CN:"帐户",zh_TW:"帳戶…",da:"Konti...",en_CA:"Accounts...",en_GB:"Accounts...",en_US:"Accounts...",et:"Kontod...",fr:"Comptes...",fr_CA:"Comptes...",de:"Accounts...",hu:"Fiókok...",it:"Account...",ja:"アカウント",ko:"계정...",no:"Kontoer...",pl:"Konta...",pt:"Contas...",ru:"Аккаунты...",es:"Cuentas...",es_AR:"Cuentas...",es_419:"Cuentas...",es_US:"Cuentas...",uk:"Облікові записи...",si:"ගිණුම්...",sl:"Računi...",id:"Akun..."},"New Direct Message...":{zh_CN:"发送新的私信...",zh_TW:"傳送新訊息",da:"Ny besked...",en_CA:"New Direct Message...",en_GB:"New Direct Message...",en_US:"New Direct Message...",et:"Saada sõnum...",fr:"Nouveau message privé...",fr_CA:"Nouveau message privé...",de:"Neue Privatnachricht...",hu:"Új privát üzenet...",it:"Nuovo messaggio diretto...",ja:"ダイレクトメッセージを作成",ko:"새 쪽지 보내기...",no:"Ny direktemelding...",pl:"Nowa Bezpośrednia Wiadomość...",pt:"Nova mensagem direta...",ru:"Новое личное сообщение...",es:"Nuevo mensaje directo...",es_AR:"Nuevo mensaje directo...",es_419:"Nuevo mensaje directo...",es_US:"Nuevo mensaje directo...",uk:"Нове особисте повідомлення...",sl:"Novo direktno sporočilo...",id:"Pesan Langsung Baru..."},Speech:{zh_CN:"语音",zh_TW:"語音",da:"Tale",en_CA:"Speech",en_GB:"Speech",en_US:"Speech",et:"Kõne",fr:"Fonction vocale",fr_CA:"Fonction vocale",de:"Spracheingabe",hu:"Felolvasás",it:"Voce",ja:"読み上げ",ko:"스피치",no:"Tale",pl:"Mowa",pt:"Voz",ru:"Речь",es:"Voz",es_AR:"Voz",es_419:"Voz",es_US:"Voz",uk:"Мовлення",sl:"Govor"},"Send Feedback":{zh_CN:"意见反馈",zh_TW:"意見回饋",da:"Send Feedback",en_CA:"Send Feedback",en_GB:"Send Feedback",en_US:"Send Feedback",et:"Saada tagasiside",fr:"Envoyer votre avis",fr_CA:"Envoyer votre avis",de:"Feedback geben",hu:"Visszajelzés küldése",it:"Invia Feedback",ja:"フィードバックを送る",ko:"피드백 보내기",no:"Send Tilbakemelding",pl:"Wyślij opinię",pt:"Enviar Feedback",ru:"Отправить отзыв",es:"Enviar Comentarios",es_AR:"Enviar Comentarios",es_419:"Enviar Comentarios",es_US:"Enviar Comentarios",uk:"Надіслати відгук",sl:"Pošlji povratne informacije",id:"Kirim Umpan Balik"},"Message @ModernDeck":{zh_CN:"私信@ModernDeck",zh_TW:"訊息@ModernDeck",da:"Skriv til @ModernDeck",en_CA:"Message @ModernDeck",en_GB:"Message @ModernDeck",en_US:"Message @ModernDeck",et:"Kirjuta @ModernDeck'ile",fr:"Envoyer un message à @ModernDeck",fr_CA:"Envoyer un message à @ModernDeck",de:"Nachricht an @ModernDeck",hu:"Üzenet küldése @ModernDeck-nek",it:"Messaggio @ModernDeck",ja:"@ModernDeck にメッセージ",ko:"@ModernDeck에게 메세지 보내기",no:"Send en Melding til @ModernDeck",pl:"Wyślij wiadomość do @ModernDeck",pt:"Mensagem @ModernDeck",ru:"Написать @ModernDeck",es:"Mensajea @ModernDeck",es_AR:"Mensajea @ModernDeck",es_419:"Mensajea @ModernDeck",es_US:"Mensajea @ModernDeck",uk:"Написати @ModernDeck",sl:"Kontaktiraj @ModernDeck"},"Updates might not work correctly if you aren't running ModernDeck from the Applications folder.\n\nWould you like to move it there?":{zh_CN:"如果您没有从应用程序文件夹运行ModernDeck，您安装的更新可能无法正常工作。\n\n您想要把ModernDeck移动至那里吗？",zh_TW:"如果您沒有從應用程式資料夾運行ModernDeck，您安裝的更新可能無法正常工作。 \n\n您想要把ModernDeck移動至那裡嗎？",da:"Opdateringer fungerer muligvis ikke korrekt, hvis du ikke kører ModernDeck fra mappen Programmer.\n\nVil du flytte programmet der til?",en_CA:"Updates might not work correctly if you aren't running ModernDeck from the Applications folder.\n\nWould you like to move it there?",en_GB:"Updates might not work correctly if you aren't running ModernDeck from the Applications folder.\n\nWould you like to move it there?",en_US:"Updates might not work correctly if you aren't running ModernDeck from the Applications folder.\n\nWould you like to move it there?",et:"Värskendused ei pruugi õigesti töötada kui te ei käivita ModernDeck'i rakenduste kaustast.\n\nKas sooviksite selle sinna teisendada?",fr:"Les mises à jour pourraient ne pas fonctionner correctement si vous n'exécutez pas ModernDeck depuis le dossier Applications.\n\nVoulez-vous le déplacer dans ce dossier?",fr_CA:"Les mises à jour pourraient ne pas fonctionner correctement si vous n'exécutez pas ModernDeck depuis le dossier Applications.\n\nVoulez-vous le déplacer dans ce dossier?",de:"Updates funktionieren möglicherweise nicht korrekt wenn ModernDeck außerhalb des Programmordners gestartet wird.\n\nMöchtest Du ModernDeck in den Programmordner verschieben?",hu:"A frissítés nem történhet megfelelően, ha a ModernDecket nem az Alkalmazások mappából futtatod.\n\nSzeretnéd oda mozgatni az alkalmazást?",it:"Gli aggiornamenti potrebbero non funzionare correttamente se non stai usando ModernDeck dalla cartella Applicazioni.\n\nVuoi spostarlo lì?",ja:"ApplicationsフォルダからModernDeckを実行していない場合、正常にアップデートできない可能性があります。\n\nそこに移動しますか？",ko:"ModernDeck을 애플리케이션 폴더에서 실행하지 않으면 업데이트가 제대로 동작하지 않을 수 있습니다.\n\n지금 바로 옮길까요?",no:"Oppdateringer vil kanskje ikke virke som de skal hvis du ikke kjører ModernDeck fra Programmer-mappen.\n\nVil du flytte den dit?",pl:"Aktualizacje mogą działać niepoprawnie jeżeli nie korzystasz z ModernDeck z folderu Aplikacje.\n\nCzy chcesz to przenieść?",pt:"As atualizações podem não funcionar corretamente se não estiver a executar o ModernDeck a partir da pasta Aplicações.\n\nGostaria de movê-lo para lá?",ru:"Обновления могут работать неправильно, если ModernDeck не находится в папке Программы.\n\nХотите перенести его туда?",es:"Es posible que las actualizaciones no funcionen correctamente si no estás ejecutando ModernDeck desde la carpeta de Aplicaciones.\n\n¿Deseas moverla ahí?",es_AR:"Es posible que las actualizaciones no funcionen correctamente si no estás ejecutando ModernDeck desde la carpeta de Aplicaciones.\n\n¿Deseas moverla ahí?",es_419:"Es posible que las actualizaciones no funcionen correctamente si no estás ejecutando ModernDeck desde la carpeta de Aplicaciones.\n\n¿Deseas moverla ahí?",es_US:"Es posible que las actualizaciones no funcionen correctamente si no estás ejecutando ModernDeck desde la carpeta de Aplicaciones.\n\n¿Deseas moverla ahí?",uk:"Оновлення можуть працювати неправильно, якщо ви не використовуєте ModernDeck з системної теки Applications.\n\nХочете перемістити його до неї?",sl:"Posodobitve mogoče ne bodo delovale pravilo, če ne zaganjate ModernDeck iz Applications mape. \n\n Ali jo želite prestaviti tja?",id:"Pembaruan mungkin tidak berjalan dengan benar jika ModernDeck tidak dijalankan dari folder Applications.\n\nPindahkan ke sini?"},"Not Now":{zh_CN:"暂时不要",zh_TW:"不是現在",da:"Ikke Nu",en_CA:"Not Now",en_GB:"Not Now",en_US:"Not Now",et:"Mitte preagu",fr:"Pas maintenant",fr_CA:"Pas maintenant",de:"Nicht jetzt",hu:"Most nem",it:"Non Adesso",ja:"今はしない",ko:"나중에 하기",no:"Ikke Nå",pl:"Nie Teraz",pt:"Agora não",ru:"Не сейчас",es:"Ahora no",es_AR:"Ahora no",es_419:"Ahora no",es_US:"Ahora no",uk:"Не зараз",si:"දැන් නොවේ",sl:"Ne zdaj",id:"Jangan Sekarang"},"Yes, Move It":{zh_CN:"是的，移动它",zh_TW:"好的，移動他",da:"Ja, flyt den",en_CA:"Yes, Move It",en_GB:"Yes, Move It",en_US:"Yes, Move It",et:"Jah, teisenda",fr:"Oui, déplacer",fr_CA:"Oui, déplacer",de:"Ja, verschieben",hu:"Igen",it:"Sì, Sposta",ja:"移動する",ko:"지금 옮기기",no:"Ja, Flytt Den",pl:"Tak, Przenieś",pt:"Sim, Mover",ru:"Переместить",es:"Sí, moverlo",es_AR:"Sí, moverlo",es_419:"Sí, moverlo",es_US:"Sí, moverlo",uk:"Перемістити",sl:"Da, prestavi",id:"Ya, Pindahkan"},"We couldn't automatically move ModernDeck to the applications folder. You may need to move it yourself.":{zh_CN:"我们不能自动将ModernDeck移动到应用程序文件夹。您可能需要自己移动它。",zh_TW:"我們無法自動將ModernDeck移動到應用程式資料夾。您可能需要自己移動它。",da:"Vi kunne ikke automatisk flytte ModernDeck til mappen programmer. Du skal muligvis selv flytte den.",en_CA:"We couldn't automatically move ModernDeck to the applications folder. You may need to move it yourself.",en_GB:"We couldn't automatically move ModernDeck to the applications folder. You may need to move it yourself.",en_US:"We couldn't automatically move ModernDeck to the applications folder. You may need to move it yourself.",et:"Me ei saanud ModernDeck'i automaatselt rakenduste kausta teisendada. Võimalusel peate selle ise teisendama.",fr:"Nous n'avons pas pu déplacer automatiquement ModernDeck dans le dossier des applications. Vous devrez peut-être le déplacer vous-même.",fr_CA:"Nous n'avons pas pu déplacer automatiquement ModernDeck dans le dossier des applications. Vous devrez peut-être le déplacer vous-même.",de:"ModernDeck konnte nicht automatisch in den Programmordner verschoben werden. Möglicherweise musst du das selber tun.",hu:"Nem sikerült a ModernDecket automatikusan átmozgatni az Alkalmazások mappába. Lehet, hogy kézzel kell megtenned.",it:"Non siamo riusciti a spostare ModernDeck automaticamente nella cartella applicazioni. Potresti doverlo spostare manualmente.",ja:"ModernDeck をアプリケーションフォルダに移動できませんでした。手動で移動する必要があるかもしれません。",ko:"ModernDeck을 응용 프로그램 폴더로 이동할수 없었습니다. 직접 이동해야 할 수 있습니다.",no:"Vi kunne ikke automatisk flytte ModernDeck til Programmer-mappen. Du må kanskje flytte den selv.",pl:"Nie mogliśmy przenieść ModernDeck to folderu Aplikacje. Może być konieczne samodzielne przeniesienie.",pt:"Não foi possível mover automaticamente o ModernDeck para a pasta de aplicações. Pode ser preciso movê-lo manualmente.",ru:"Мы не смогли автоматически переместить ModernDeck в папку Программы. Возможно, вам придётся переместить его самостоятельно.",es:"No hemos podido mover ModernDeck a la carpeta de Aplicaciones. Es posible que tengas que moverla tú.",es_AR:"No hemos podido mover ModernDeck a la carpeta de Aplicaciones. Es posible que tengas que moverla tú.",es_419:"No hemos podido mover ModernDeck a la carpeta de Aplicaciones. Es posible que tengas que moverla tú.",es_US:"No hemos podido mover ModernDeck a la carpeta de Aplicaciones. Es posible que tengas que moverla tú.",uk:"Ми не змогли автоматично перемістити ModernDeck до системної теки Applications. Можливо, Вам доведеться зробити це самостійно.",sl:"Avtomatski premik ModernDeck v Applications mapo ni uspel. Premaknite jo sami."},OK:{zh_CN:"好的",zh_TW:"確定",da:"OK",en_CA:"OK",en_GB:"OK",en_US:"OK",et:"OK",fr:"OK",fr_CA:"OK",de:"OK",hu:"OK",it:"OK",ja:"OK",ko:"확인",no:"OK",pl:"OK",pt:"Ok",ru:"ОК",es:"Aceptar",es_AR:"Aceptar",es_419:"Aceptar",es_US:"Aceptar",uk:"OK",si:"හරි",sl:"Vredu",id:"Oke"},Retry:{zh_CN:"重试",zh_TW:"重試",da:"Prøv igen",en_CA:"Retry",en_GB:"Retry",en_US:"Retry",et:"Proovi uuesti",fr:"Réessayer",fr_CA:"Réessayer",de:"Erneut versuchen",hu:"Újra",it:"Riprova",ja:"再試行",ko:"재시도",no:"Prøv igjen",pl:"Ponów próbę",pt:"Tentar novamente",ru:"Попробовать ещё",es:"Reintentar",es_AR:"Reintentar",es_419:"Reintentar",es_US:"Reintentar",uk:"Повторити",si:"නැවත උත්සාහ කරන්න",sl:"Poizkusi znova",id:"Coba lagi"},Close:{zh_CN:"关闭",zh_TW:"關閉​​​",da:"Luk",en_CA:"Close",en_GB:"Close",en_US:"Close",et:"Sulge",fr:"Fermer",fr_CA:"Fermer",de:"Schließen",hu:"Bezárás",it:"Chiudi",ja:"閉じる",ko:"닫기",no:"Lukk",pl:"Zamknij",pt:"Fechar",ru:"Закрыть",es:"Cerrar",es_AR:"Cerrar",es_419:"Cerrar",es_US:"Cerrar",uk:"Закрити",si:"වසන්න",sl:"Zapri",id:"Tutup"},"About ModernDeck":{zh_CN:"关于 ModernDeck",zh_TW:"關於 ModernDeck",da:"Om ModernDeck",en_CA:"About ModernDeck",en_GB:"About ModernDeck",en_US:"About ModernDeck",et:"ModernDeck'i teave",fr:"À propos de ModernDeck",fr_CA:"À propos de ModernDeck",de:"Über ModernDeck",hu:"A ModernDeck névjegye",it:"Informazioni Su ModernDeck",ja:"ModernDeck について",ko:"ModernDeck 정보",no:"Om ModernDeck",pl:"O ModernDeck",pt:"Sobre o ModernDeck",ru:"О ModernDeck",es:"Acerca de ModernDeck",es_AR:"Acerca de ModernDeck",es_419:"Acerca de ModernDeck",es_US:"Acerca de ModernDeck",uk:"Про ModernDeck",sl:"O ModernDeck",id:"Tentang ModernDeck"},"New Tweet...":{zh_CN:"新推文",zh_TW:"新推文…",da:"Nyt Tweet...",en_CA:"New Tweet...",en_GB:"New Tweet...",en_US:"New Tweet...",et:"Uus säuts...",fr:"Nouveau Tweet...",fr_CA:"Nouveau Tweet...",de:"Neuer Tweet...",hu:"Új Tweet...",it:"Nuovo Tweet...",ja:"ツイートを作成",ko:"새 트윗 보내기...",no:"Ny tweet...",pl:"Nowy Tweet...",pt:"Novo Tweet...",ru:"Новый твит...",es:"Nuevo Tweet...",es_AR:"Nuevo Tweet...",es_419:"Nuevo Tweet...",es_US:"Nuevo Tweet...",uk:"Створити Твіт...",sl:"Nov Tweet...",id:"Tweet Baru..."},"Open ModernDeck":{zh_CN:"启动 ModernDeck",zh_TW:"開啟 ModernDeck",da:"Åbn ModernDeck",en_CA:"Open ModernDeck",en_GB:"Open ModernDeck",en_US:"Open ModernDeck",et:"Ava ModernDeck",fr:"Ouvrir ModernDeck",fr_CA:"Ouvrir ModernDeck",de:"ModernDeck öffnen",hu:"ModernDeck megnyitása",it:"Apri ModernDeck",ja:"ModernDeckを開く",ko:"ModernDeck 열기",no:"Åpne ModernDeck",pl:"Otwórz ModernDeck",pt:"Abrir ModernDeck",ru:"Открыть ModernDeck",es:"Abrir ModernDeck",es_AR:"Abrir ModernDeck",es_419:"Abrir ModernDeck",es_US:"Abrir ModernDeck",uk:"Відкрити ModernDeck",sl:"Odpri ModernDeck",id:"Buka ModernDeck"},"Settings...":{zh_CN:"设置...",zh_TW:"設定…",da:"Indstillinger...",en_CA:"Settings...",en_GB:"Settings...",en_US:"Settings...",et:"Seaded...",fr:"Paramètres...",fr_CA:"Paramètres...",de:"Einstellungen...",hu:"Beállítások...",it:"Impostazioni...",ja:"設定",ko:"설정...",no:"Innstillinger...",pl:"Ustawienia...",pt:"Configurações...",ru:"Настройки...",es:"Ajustes...",es_AR:"Ajustes...",es_419:"Ajustes...",es_US:"Ajustes...",uk:"Налаштування...",si:"සැකසුම්...",sl:"Nastavitve...",id:"Pengaturan..."},Exit:{zh_CN:"退出",zh_TW:"離開",da:"Afslut",en_CA:"Exit",en_GB:"Exit",en_US:"Exit",et:"Välju",fr:"Quitter",fr_CA:"Quitter",de:"Beenden",hu:"Kilépés",it:"Esci",ja:"終了",ko:"끝내기",no:"Avslutt",pl:"Wyjście",pt:"Sair",ru:"Выход",es:"Salir",es_AR:"Salir",es_419:"Salir",es_US:"Salir",uk:"Вийти",sl:"Zapri",id:"Keluar"},"Twitter Status":{zh_CN:"Twitter 状态",zh_TW:"Twitter 狀態",da:"Twitter Status",en_CA:"Twitter Status",en_GB:"Twitter Status",en_US:"Twitter Status",et:"Twitteri olek",fr:"Statut Twitter",fr_CA:"Statut Twitter",de:"Twitter-Status",hu:"Twitter állapota",it:"Stato di Twitter",ja:"Twitterのステータス",ko:"트위터 상태",no:"Twitter Status",pl:"Status Twittera",pt:"Estado do Twitter",ru:"Состояние Твиттера",es:"Estado de Twitter",es_AR:"Estado de Twitter",es_419:"Estado de Twitter",es_US:"Estado de Twitter",uk:"Стан Твіттеру",sl:"Twitter Status",id:"Status Twitter"},"Check for updates...":{zh_CN:"检查更新...",zh_TW:"檢查更新...",da:"Tjek for opdateringer...",en_CA:"Check for updates...",en_GB:"Check for updates...",en_US:"Check for updates...",et:"Otsi värskendusi...",fr:"Recherche de mises à jour...",fr_CA:"Recherche de mises à jour...",de:"Nach Updates suchen...",hu:"Frissítés keresése...",it:"Controlla gli Aggiornamenti...",ja:"アップデートを確認",ko:"업데이트 확인...",no:"Se etter oppdateringer...",pl:"Sprawdź aktualizacje...",ru:"Проверить обновления...",es:"Buscar actualizaciones...",es_AR:"Buscar actualizaciones...",es_419:"Buscar actualizaciones...",es_US:"Buscar actualizaciones...",uk:"Перевірити оновлення...",sl:"Preveri za posodobitve...",id:"Periksa pembaruan..."}};var lang=store.get("mtd_lang"),I18n=function(key){var foundStr=i18nMain[key];return foundStr?foundStr[lang]||key:(console.warn("Main process missing translation: "+key),key)},loginWindow_electron=require("electron"),loginWindow_BrowserWindow=loginWindow_electron.BrowserWindow;function makeLoginWindow(url,teams){var originalUrl=url;return HostManager.loginWindow=new loginWindow_BrowserWindow({width:710,height:490,webPreferences:{scrollBounce:!0,nodeIntegration:!1},parent:HostManager.mainWindow||null,modal:!0,autoHideMenuBar:!0}),HostManager.loginWindow.on("closed",(function(){HostManager.loginWindow=null})),HostManager.loginWindow.webContents.on("will-navigate",(function(event,url){var _a,_b,_c,_d,_e,_f,_g,_h;console.log("will-navigate",url);var shell=loginWindow_electron.shell;return url.indexOf("https://tweetdeck.twitter.com")>=0&&!teams?(console.log("Hello tweetdeck!"),null===(_b=null===(_a=HostManager.loginWindow)||void 0===_a?void 0:_a.close)||void 0===_b||_b.call(_a),null===(_d=null===(_c=HostManager.mainWindow)||void 0===_c?void 0:_c.reload)||void 0===_d||_d.call(_c),void event.preventDefault()):url.indexOf("twitter.com/logout")>=0?(console.log("Hello logout!"),null===(_f=null===(_e=HostManager.loginWindow)||void 0===_e?void 0:_e.close)||void 0===_f||_f.call(_e),null===(_h=null===(_g=HostManager.mainWindow)||void 0===_g?void 0:_g.reload)||void 0===_h||_h.call(_g),void event.preventDefault()):url.indexOf("twitter.com/logout")>=0||url.indexOf("twitter.com/login")>=0||url.indexOf("twitter.com/i/flow/login")>=0||url.indexOf("twitter.com/account/login_verification")>=0||teams?void 0:url.indexOf("twitter.com/account")>=0||url.indexOf("twitter.com/signup")>=0||url.indexOf("twitter.com/signup")>=0?(event.preventDefault(),void shell.openExternal(url)):void(url.indexOf("twitter.com/sessions")>=0||event.preventDefault())})),HostManager.loginWindow.webContents.on("did-navigate-in-page",(function(event,url){var _a,_b,_c,_d,_e,_f,_g,_h,_j;return console.log("did-navigate-in-page",url),"https://mobile.twitter.com/"===url?(event.preventDefault(),void(null===(_b=null===(_a=HostManager.loginWindow)||void 0===_a?void 0:_a.close)||void 0===_b||_b.call(_a))):url.indexOf("https://tweetdeck.twitter.com")>=0?(console.log("Hello tweetdeck2!"),null===(_d=null===(_c=HostManager.mainWindow)||void 0===_c?void 0:_c.loadURL)||void 0===_d||_d.call(_c,url),null===(_f=null===(_e=HostManager.loginWindow)||void 0===_e?void 0:_e.close)||void 0===_f||_f.call(_e),void event.preventDefault()):url.indexOf("/i/flow/signup")>=0||url.indexOf("/i/flow/password_reset")>=0?(event.preventDefault(),null===(_j=null===(_h=null===(_g=HostManager.loginWindow)||void 0===_g?void 0:_g.webContents)||void 0===_h?void 0:_h.goBack)||void 0===_j||_j.call(_h),void loginWindow_electron.shell.openExternal(url)):void(url.indexOf("twitter.com/logout")>=0||url.indexOf("twitter.com/login")>=0||url.indexOf("twitter.com/i/flow/login")>=0||HostManager.loginWindow&&HostManager.loginWindow.loadURL(originalUrl))})),HostManager.loginWindow.webContents.on("new-window",(function(event,url){console.log("new-window",url),event.preventDefault(),loginWindow_electron.shell.openExternal(url)})),HostManager.loginWindow.loadURL(url),HostManager.loginWindow}var _a=require("electron"),Tray=_a.Tray,Menu=_a.Menu,nativeImage=_a.nativeImage,tray_app=_a.app;function makeTray(){if(null===HostManager.tray){var pathName="common".concat(separator,"assets").concat(separator)+"img".concat(separator,"app").concat(separator).concat("darwin"===process.platform?"macOSTrayTemplate.png":"Tray.png");nativeImage.createFromPath(pathName).setTemplateImage(!0),HostManager.tray=new Tray(pathName);var contextMenu=Menu.buildFromTemplate([{label:I18n("Open ModernDeck"),click:function(){showHiddenWindow()}},{label:"darwin"===process.platform?I18n("Preferences..."):I18n("Settings..."),click:function(){var _a,_b;HostManager.mainWindow&&(HostManager.mainWindow.show(),null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b||_b.send("openSettings"))}},{visible:void 0===process.windowsStore&&"disabled"!==desktopConfig.autoUpdatePolicy,label:"darwin"===process.platform?I18n("Check for Updates..."):I18n("Check for updates..."),click:function(){var _a,_b;HostManager.mainWindow&&(HostManager.mainWindow.show(),null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b||_b.send("checkForUpdatesMenu"))}},{type:"separator"},{label:I18n("New Tweet..."),click:function(){var _a,_b;HostManager.mainWindow&&(HostManager.mainWindow.show(),null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b||_b.send("newTweet"))}},{label:I18n("New Direct Message..."),click:function(){var _a,_b;HostManager.mainWindow&&(HostManager.mainWindow.show(),null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b||_b.send("newDM"))}},{type:"separator"},{label:"darwin"===process.platform?I18n("Quit"):I18n("Exit"),click:function(){HostManager.mainWindow&&(HostManager.closeForReal=!0,main_autoUpdater.quitAndInstall(!0,!0),setTimeout((function(){tray_app.quit()}),200))}}]);HostManager.tray.setToolTip("ModernDeck"),HostManager.tray.setContextMenu(contextMenu),HostManager.tray.on("click",showHiddenWindow)}}function destroyTray(){var _a,_b;null===(_b=null===(_a=HostManager.tray)||void 0===_a?void 0:_a.destroy)||void 0===_b||_b.call(_a),HostManager.tray=null}function showHiddenWindow(){HostManager.mainWindow&&(HostManager.mainWindow.show(),HostManager.mainWindowHidden=!1,HostManager.enableTray||destroyTray())}var TitleBarStyle,__awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):(value=result.value,value instanceof P?value:new P((function(resolve){resolve(value)}))).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__generator=function(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}},mainWindow_electron=require("electron"),mainWindow_app=mainWindow_electron.app,mainWindow_BrowserWindow=mainWindow_electron.BrowserWindow,protocol=mainWindow_electron.protocol,ipcMain=mainWindow_electron.ipcMain,mainWindow_dialog=mainWindow_electron.dialog,mainWindow_Menu=mainWindow_electron.Menu,session=mainWindow_electron.session,remote=require("@electron/remote/main"),mainWindow_fs=require("fs");function exitFully(){HostManager.closeForReal=!0,mainWindow_app.relaunch(),mainWindow_app.exit()}function saveWindowBounds(){if(HostManager.mainWindow)try{var bounds=HostManager.mainWindow.getBounds();store.set("mtd_fullscreen",HostManager.mainWindow.isFullScreen()),store.set("mtd_maximised",HostManager.mainWindow.isMaximized()),HostManager.mainWindow.isMaximized()||HostManager.mainWindow.isFullScreen()||store.set("mtd_windowBounds",HostManager.mainWindow.getBounds());var matchedDisplay=mainWindow_electron.screen.getDisplayMatching({x:bounds.x,y:bounds.y,width:bounds.width,height:bounds.height});store.set("mtd_usedDisplay",matchedDisplay.id)}catch(e){console.error(e)}}!function(TitleBarStyle){TitleBarStyle.DEFAULT="default",TitleBarStyle.HIDDEN="hidden"}(TitleBarStyle||(TitleBarStyle={}));var makeWindow=function(){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m,_o,_p,_q,_r,_s,_t,_u,_v,_w,_x,_y,_z,_0,_1,_2,_3,_4,_5,_6,_7;if(!mainWindow_app.requestSingleInstanceLock())return HostManager.closeForReal=!0,void mainWindow_app.quit();store.has("mtd_nativetitlebar")||store.set("mtd_nativetitlebar",!1),protocol.registerFileProtocol("moderndeck",mtdSchemeHandler),HostManager.isRestarting=!1;var useFrame=store.get("mtd_nativetitlebar")||store.get("mtd_safemode")||"darwin"===process.platform,titleBarStyle=TitleBarStyle.HIDDEN;store.get("mtd_nativetitlebar")&&(titleBarStyle=TitleBarStyle.DEFAULT),store.has("mtd_updatechannel")&&("beta"===store.get("mtd_updatechannel")&&(main_autoUpdater.allowPrerelease=!0),main_autoUpdater.channel=store.get("mtd_updatechannel"));var bounds=store.get("mtd_windowBounds")||{},useXY=!!bounds.x&&!!bounds.y;if(HostManager.mainWindow=new mainWindow_BrowserWindow({width:bounds.width||1024,height:bounds.height||660,x:useXY?bounds.x:void 0,y:useXY?bounds.y:void 0,webPreferences:{defaultFontFamily:{standard:"Roboto",serif:"Roboto",sansSerif:"Roboto",monospace:"RobotoMono"},backgroundThrottling:!0,nodeIntegration:!0,contextIsolation:!1,nodeIntegrationInSubFrames:!1,webgl:!1,plugins:!1,scrollBounce:!0},autoHideMenuBar:!0,title:"ModernDeck",frame:useFrame,titleBarStyle,minWidth:350,show:!1,backgroundColor:"#111"}),"darwin"===process.platform&&!mainWindow_app.isInApplicationsFolder()){var dialog_1=mainWindow_electron.dialog;dialog_1.showMessageBox({type:"warning",title:"ModernDeck",message:I18n("Updates might not work correctly if you aren't running ModernDeck from the Applications folder.\n\nWould you like to move it there?"),buttons:[I18n("Not Now"),I18n("Yes, Move It")]}).then((function(event){if(1==event.response){var moveMe=void 0;try{moveMe=mainWindow_app.moveToApplicationsFolder()}catch(e){console.error(e)}moveMe||dialog_1.showMessageBox({type:"error",title:"ModernDeck",message:I18n("We couldn't automatically move ModernDeck to the applications folder. You may need to move it yourself."),buttons:[I18n("OK")]})}}))}HostManager.mainWindow.on("page-title-updated",(function(event){event.preventDefault()})),HostManager.mainWindow.on("close",(function(_event){setTimeout(saveWindowBounds,0)})),setInterval(saveWindowBounds,6e4),HostManager.mainWindow.show(),HostManager.mainWindowHidden=!1,remote.initialize(),remote.enable(HostManager.mainWindow.webContents),mainWindow_app.on("remote-require",(function(event,_moduleName){event.preventDefault()})),mainWindow_app.on("remote-get-global",(function(event,_moduleName){event.preventDefault()})),mainWindow_app.on("remote-get-builtin",(function(_,event,moduleName){"Menu"!==moduleName&&event.preventDefault()})),mainWindow_app.on("remote-get-current-window",(function(event,_moduleName){event.preventDefault()})),mainWindow_app.on("remote-get-current-web-contents",(function(event,_moduleName){event.preventDefault()})),updateAppTag();try{null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b||_b.executeJavaScript('\n\t\t\tdocument.getElementsByClassName("js-signin-ui block")[0].innerHTML =\n\t\t\t`<img class="mtd-loading-logo" src="moderndeck://assets/img/moderndeck.svg" style="display: none;">\n\t\t\t<div class="preloader-wrapper active">\n\t\t\t\t<div class="spinner-layer">\n\t\t\t\t\t<div class="circle-clipper left">\n\t\t\t\t\t\t<div class="circle"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="gap-patch">\n\t\t\t\t\t\t<div class="circle"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="circle-clipper right">\n\t\t\t\t\t\t<div class="circle"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>`;\n\n\t\t\tif (typeof mtdLoadStyleCSS === "undefined") {\n\t\t\t\tmtdLoadStyleCSS = `\n\t\t\t\t\timg.spinner-centered {\n\t\t\t\t\t\tdisplay:none!important\n\t\t\t\t\t}\n\t\t\t\t`\n\t\t\t\tmtdLoadStyle = document.createElement("style");\n\t\t\t\tmtdLoadStyle.appendChild(document.createTextNode(mtdLoadStyleCSS))\n\t\t\t\tdocument.head.appendChild(mtdLoadStyle);\n\t\t\t}\n\n\t\t\tif (document.getElementsByClassName("spinner-centered")[0]) {\n\t\t\t\tdocument.getElementsByClassName("spinner-centered")[0].remove();\n\t\t\t}\n\n\t\t\tdocument.getElementsByTagName("html")[0].style = "background: #111;";\n\t\t\tdocument.getElementsByTagName("body")[0].style = "background: #111;";\n\t\t')}catch(e){}null===(_d=null===(_c=HostManager.mainWindow)||void 0===_c?void 0:_c.webContents)||void 0===_d||_d.on("dom-ready",(function(){var _a,_b,_c,_d;null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b||_b.executeJavaScript('\n\t\t\tdocument.getElementsByTagName("html")[0].style = "background: #111!important;";\n\t\t\tdocument.getElementsByTagName("body")[0].style = "background: #111!important;";\n\n\t\t\tif (typeof mtdLoadStyleCSS === "undefined") {\n\t\t\t\tmtdLoadStyleCSS = `\n\t\t\t\t\timg.spinner-centered {\n\t\t\t\t\t\tdisplay:none!important\n\t\t\t\t\t}\n\t\t\t\t`\n\t\t\t\tmtdLoadStyle = document.createElement("style");\n\t\t\t\tmtdLoadStyle.appendChild(document.createTextNode(mtdLoadStyleCSS))\n\t\t\t\tdocument.head.appendChild(mtdLoadStyle);\n\t\t\t}\n\n\t\t\tif (document.getElementsByClassName("spinner-centered")[0]) {\n\t\t\t\tdocument.getElementsByClassName("spinner-centered")[0].remove();\n\t\t\t}\n\n\t\t\tdocument.getElementsByClassName("js-signin-ui block")[0].innerHTML =\n\t\t\t`<img class="mtd-loading-logo" src="moderndeck://assets/img/moderndeck.svg" style="display: none;">\n\t\t\t<div class="preloader-wrapper active">\n\t\t\t\t<div class="spinner-layer">\n\t\t\t\t\t<div class="circle-clipper left">\n\t\t\t\t\t\t<div class="circle"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="gap-patch">\n\t\t\t\t\t\t<div class="circle"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="circle-clipper right">\n\t\t\t\t\t\t<div class="circle"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>`;\n\t\t'),null===(_d=null===(_c=HostManager.mainWindow)||void 0===_c?void 0:_c.webContents)||void 0===_d||_d.executeJavaScript('\n\t\t\tconst baseUrl = document.createElement("meta");\n\t\t\tbaseUrl.setAttribute("name", "moderndeck-base-url");\n\t\t\tbaseUrl.setAttribute("content", "moderndeck://");\n\t\t\tdocument.head.appendChild(baseUrl);\n\t\t\t\n\t\t\tconst InjectScript2 = document.createElement("script");\n\t\t\tInjectScript2.src = "moderndeck://assets/libraries/moduleraid.min.js";\n\t\t\tInjectScript2.type = "text/javascript";\n\t\t\tdocument.head.appendChild(InjectScript2);'+(store.get("mtd_safemode")?'document.getElementsByTagName("html")[0].classList.add("mtd-disable-css");':'const injStyles = document.createElement("link");\n\t\t\tinjStyles.rel = "stylesheet";\n\t\t\tinjStyles.href = "moderndeck://assets/css/moderndeck.css";\n\t\t\tdocument.head.appendChild(injStyles);')+'const InjectScript = document.createElement("script");\n\t\t\tInjectScript.src = "moderndeck://assets/js/moderndeck.js";\n\t\t\tInjectScript.type = "text/javascript";\n\t\t\tdocument.head.appendChild(InjectScript);\n\t\t'),updateAppTag()})),null===(_f=null===(_e=HostManager.mainWindow)||void 0===_e?void 0:_e.webContents)||void 0===_f||_f.on("did-fail-load",(function(_event,code,desc){-3!==code&&-11!==code&&-2!==code&&-1!==code&&(shell.beep(),HostManager.errorWindow=new BrowserWindow({width:600,height:260,webPreferences:{scrollBounce:!0,nodeIntegration:!0},parent:HostManager.mainWindow,autoHideMenuBar:!0}),HostManager.shouldQuitIfErrorClosed=!0,errorWindow.webContents.on("new-window",(function(event,url){event.preventDefault(),shell.openExternal(url)})),errorWindow.on("closed",(function(){errorWindow=null,HostManager.shouldQuitIfErrorClosed&&errorWindow_app.quit()})),errorWindow.loadURL(__dirname+separator+"sadmoderndeck.html"),errorWindow.webContents.on("did-start-navigation",(function(event,url){event.preventDefault()})),HostManager.mainWindow.hide(),HostManager.errorWindow.webContents.executeJavaScript('\n\t\t\tdocument.getElementById("code").innerHTML = "'.concat(desc,'";\n\t\t\tdocument.getElementById("close").innerHTML = "').concat(I18n("Close"),'";\n\t\t\tdocument.getElementById("retry").innerHTML = "').concat(I18n("Retry"),'";\n\t\t\tdocument.getElementById("twitterStatus").innerHTML = "').concat(I18n("Twitter Status"),'";\n\t\t')),console.log(desc))})),null===(_h=null===(_g=HostManager.mainWindow)||void 0===_g?void 0:_g.webContents)||void 0===_h||_h.session.webRequest.onHeadersReceived({urls:["https://tweetdeck.twitter.com/*"]},(function(details,callback){var foo=details.responseHeaders;foo["content-security-policy"]=["default-src 'self'; connect-src * moderndeck:; font-src https: blob: data: * moderndeck:; frame-src https: moderndeck:; frame-ancestors 'self' https: moderndeck:; img-src https: file: data: blob: moderndeck:; media-src * moderndeck: blob: https:; object-src 'self' https:; script-src 'self' 'unsafe-eval' https://moderndeck.app moderndeck: https://*.twitter.com https://*.twimg.com https://api-ssl.bitly.com blob:; style-src 'self' 'unsafe-inline' 'unsafe-eval' https: moderndeck: blob:;"],callback({responseHeaders:foo})})),null===(_o=null===(_m=null===(_l=null===(_k=null===(_j=HostManager.mainWindow)||void 0===_j?void 0:_j.webContents)||void 0===_k?void 0:_k.session)||void 0===_l?void 0:_l.webRequest)||void 0===_m?void 0:_m.onBeforeSendHeaders)||void 0===_o||_o.call(_m,{urls:["https://twitter.com/i/jot*","https://tweetdeck.twitter.com/Users*"]},(function(_details,callback){callback({cancel:!0})})),null===(_r=null===(_q=null===(_p=HostManager.mainWindow)||void 0===_p?void 0:_p.webContents)||void 0===_q?void 0:_q.loadURL)||void 0===_r||_r.call(_q,"https://tweetdeck.twitter.com"),null===(_u=null===(_t=null===(_s=HostManager.mainWindow)||void 0===_s?void 0:_s.webContents)||void 0===_t?void 0:_t.on)||void 0===_u||_u.call(_t,"will-navigate",(function(event,url){var shell=mainWindow_electron.shell;console.log(url),url.indexOf("https://tweetdeck.twitter.com")<0&&url.indexOf("moderndeck://.")<0&&(event.preventDefault(),url.indexOf("twitter.com/login")>=0||url.indexOf("twitter.com/i/flow/login")>=0||url.indexOf("twitter.com/logout")>=0?(console.log("this is a login window! will-navigate"),makeLoginWindow(url,!1)):shell.openExternal(url)),updateAppTag()})),null===(_x=null===(_w=null===(_v=HostManager.mainWindow)||void 0===_v?void 0:_v.webContents)||void 0===_w?void 0:_w.on)||void 0===_x||_x.call(_w,"new-window",(function(event,url){var shell=mainWindow_electron.shell;return event.preventDefault(),console.log(url),url.indexOf("https://twitter.com/teams/authorize")>=0?(console.log("this is a login teams window! new-window"),event.newGuest=makeLoginWindow(url,!0)):url.indexOf("twitter.com/login")>=0||url.indexOf("twitter.com/i/flow/login")>=0||url.indexOf("twitter.com/logout")>=0?(console.log("this is a login non-teams window! new-window"),event.newGuest=makeLoginWindow(url,!1)):shell.openExternal(url).catch((function(){var _a,_b;null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b||_b.send("failedOpenUrl")})),event.newGuest})),null===(_0=null===(_z=null===(_y=HostManager.mainWindow)||void 0===_y?void 0:_y.webContents)||void 0===_z?void 0:_z.on)||void 0===_0||_0.call(_z,"context-menu",(function(_event,params){var _a,_b;null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b||_b.send("context-menu",params)})),ipcMain.on("getDesktopConfig",(function(){var _a,_b;null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b||_b.send("desktopConfig",desktopConfig)})),ipcMain.on("focus",(function(){var _a,_b;console.log("Focus!"),null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.focus)||void 0===_b||_b.call(_a)})),ipcMain.on("nativeContextMenu",(function(_event,params){console.log(params);var newMenu=mainWindow_Menu.buildFromTemplate(params);console.log(newMenu),newMenu.popup()})),ipcMain.on("errorReload",(function(){HostManager.mainWindow.reload(),HostManager.mainWindow.show(),HostManager.errorWindow.close()})),ipcMain.on("loadSettingsDialog",(function(){mainWindow_dialog.showOpenDialog({filters:[{name:I18n("Preferences JSON File"),extensions:["json"]}]}).then((function(results){console.log(results),void 0!==results.filePaths&&mainWindow_fs.readFile(results.filePaths[0],"utf-8",(function(_,load){var _a,_b;null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b||_b.send("settingsReceived",JSON.parse(load))}))}))})),ipcMain.on("tweetenImportDialog",(function(){mainWindow_dialog.showOpenDialog({filters:[{name:I18n("Tweeten Settings JSON"),extensions:["json"]}]}).then((function(results){void 0!==results.filePaths&&mainWindow_fs.readFile(results.filePaths[0],"utf-8",(function(_,load){var _a,_b;null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b||_b.send("tweetenSettingsReceived",JSON.parse(load))}))}))})),ipcMain.on("saveSettings",(function(_event,params){mainWindow_dialog.showSaveDialog({title:I18n("ModernDeck Preferences"),defaultPath:"settings.json",filters:[{name:I18n("Preferences JSON File"),extensions:["json"]}]}).then((function(results){void 0!==results.filePath&&mainWindow_fs.writeFile(results.filePath,params,(function(_){}))}))})),ipcMain.on("errorQuit",(function(){mainWindow_app.quit()})),ipcMain.on("drawerOpen",(function(){var _a,_b;console.log("open"),null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b||_b.executeJavaScript('document.querySelector("html").classList.add("mtd-drawer-open");')})),ipcMain.on("drawerClose",(function(){var _a,_b;console.log("close"),null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b||_b.executeJavaScript('document.querySelector("html").classList.remove("mtd-drawer-open");')})),ipcMain.on("maximizeButton",(function(){var window=mainWindow_BrowserWindow.getFocusedWindow();window&&(window.isMaximized()?window.unmaximize():window.maximize())})),ipcMain.on("minimize",(function(){mainWindow_BrowserWindow.getFocusedWindow().minimize()})),ipcMain.on("copy",(function(){var _a,_b,_c;null===(_c=null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b?void 0:_b.copy)||void 0===_c||_c.call(_b)})),ipcMain.on("cut",(function(){var _a,_b,_c;null===(_c=null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b?void 0:_b.cut)||void 0===_c||_c.call(_b)})),ipcMain.on("paste",(function(){var _a,_b,_c;null===(_c=null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b?void 0:_b.paste)||void 0===_c||_c.call(_b)})),ipcMain.on("delete",(function(){var _a,_b,_c;null===(_c=null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b?void 0:_b.delete)||void 0===_c||_c.call(_b)})),ipcMain.on("selectAll",(function(){var _a,_b,_c;null===(_c=null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b?void 0:_b.selectAll)||void 0===_c||_c.call(_b)})),ipcMain.on("undo",(function(){var _a,_b,_c;null===(_c=null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b?void 0:_b.undo)||void 0===_c||_c.call(_b)})),ipcMain.on("redo",(function(){var _a,_b,_c;null===(_c=null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b?void 0:_b.redo)||void 0===_c||_c.call(_b)})),ipcMain.on("copyImage",(function(_event,arg){var _a,_b,_c;null===(_c=null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b?void 0:_b.copyImageAt)||void 0===_c||_c.call(_b,arg.x,arg.y)})),ipcMain.on("saveImage",(function(_event,arg){!function(url){if(!url)throw'saveImageAs requires "URL" as an argument';var fileType=url.match(/(?<=format=)(\w{3,4})|(?<=\.)(\w{3,4}(?=\?))/g)[0]||"file",fileName=url.match(/(?<=media\/)[\w\d_\-]+|[\w\d_\-]+(?=\.m)/g)[0]||"jpg",savePath=dialog.showSaveDialogSync({defaultPath:fileName+"."+fileType});if(savePath)try{var file_1=fs.createWriteStream(savePath);https.get(url,(function(response){response.pipe(file_1)}))}catch(e){console.log(e)}}(arg)})),ipcMain.on("inspectElement",(function(_event,arg){var _a,_b,_c;null===(_c=null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b?void 0:_b.inspectElement)||void 0===_c||_c.call(_b,arg.x,arg.y)})),ipcMain.on("showEmojiPanel",(function(){mainWindow_app.showEmojiPanel()})),ipcMain.on("restartApp",(function(){setTimeout(exitFully,100)})),ipcMain.on("restartAndInstallUpdates",(function(){HostManager.closeForReal=!0,main_autoUpdater.quitAndInstall(!1,!0)})),ipcMain.on("destroyEverything",(function(){return __awaiter(void 0,void 0,void 0,(function(){var ses;return __generator(this,(function(_a){switch(_a.label){case 0:return ses=session.defaultSession,store.clear(),ses.flushStorageData(),[4,ses.clearCache()];case 1:return _a.sent(),ses.clearHostResolverCache(),[4,ses.cookies.flushStore()];case 2:return _a.sent(),ses.clearStorageData({storages:["appcache","cookies","filesystem","indexdb","localstorage","shadercache","websql","serviceworkers"],quotas:["temporary","persistent","syncable"]}),setTimeout(exitFully,500),[2]}}))}))})),ipcMain.on("setNativeTitlebar",(function(_event,arg){HostManager.isRestarting=!0,HostManager.mainWindow&&(HostManager.closeForReal=!0,HostManager.mainWindow.close()),store.set("mtd_nativetitlebar",arg),setTimeout(exitFully,100)})),HostManager.mainWindow.on("close",(function(event){HostManager.enableBackground&&!HostManager.closeForReal&&(event.preventDefault(),HostManager.mainWindow.hide(),HostManager.mainWindowHidden=!0,HostManager.enableTray||"darwin"===process.platform||makeTray())})),ipcMain.on("enableTray",(function(_event){HostManager.enableTray=!0,makeTray()})),ipcMain.on("disableTray",(function(_event){HostManager.enableTray=!1,destroyTray()})),ipcMain.on("enableBackground",(function(_event){HostManager.enableBackground=!0})),ipcMain.on("disableBackground",(function(_event){HostManager.enableBackground=!1})),HostManager.mainWindow.on("closed",(function(){HostManager.mainWindow=null})),HostManager.mainWindow.on("maximize",(function(){var _a,_b,_c;null===(_c=null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b?void 0:_b.executeJavaScript)||void 0===_c||_c.call(_b,'\t\t\tdocument.querySelector("html").classList.add("mtd-maximized");\t\t\tdocument.querySelector(".windowcontrol.max").innerHTML = "&#xE3E0";\t\t')})),HostManager.mainWindow.on("unmaximize",(function(){var _a,_b,_c;null===(_c=null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b?void 0:_b.executeJavaScript)||void 0===_c||_c.call(_b,'\t\t\tdocument.querySelector("html").classList.remove("mtd-maximized");\t\t\tdocument.querySelector(".windowcontrol.max").innerHTML = "&#xE3C6";\t\t')})),store.get("mtd_maximised")&&(null===(_2=null===(_1=HostManager.mainWindow)||void 0===_1?void 0:_1.maximize)||void 0===_2||_2.call(_1)),HostManager.mainWindow.on("enter-full-screen",(function(){var _a,_b,_c;null===(_c=null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b?void 0:_b.executeJavaScript)||void 0===_c||_c.call(_b,'document.querySelector("html").classList.remove("mtd-app");\t\t\tdocument.querySelector("html").classList.remove("mtd-app-win");\t\t\tdocument.querySelector("html").classList.remove("mtd-app-mac");\t\t\tdocument.querySelector("html").classList.remove("mtd-app-linux");\t\t')})),store.get("mtd_fullscreen")&&(null===(_5=null===(_4=null===(_3=HostManager.mainWindow)||void 0===_3?void 0:_3.webContents)||void 0===_4?void 0:_4.executeJavaScript)||void 0===_5||_5.call(_4,'document.querySelector("html").classList.remove("mtd-app");'),null===(_7=null===(_6=HostManager.mainWindow)||void 0===_6?void 0:_6.setFullScreen)||void 0===_7||_7.call(_6,!0)),HostManager.mainWindow.on("leave-full-screen",(function(){store.set("mtd_fullscreen",!1),updateAppTag()})),updateAppTag()},getWebContents=function(){return HostManager.mainWindow?HostManager.mainWindow.webContents:null},autoUpdater_ipcMain=require("electron").ipcMain,autoUpdater=require("electron-updater").autoUpdater,config_a=require("electron"),config_app=config_a.app,config_dialog=config_a.dialog,globalShortcut=config_a.globalShortcut,config_fs=require("fs"),menubar_electron=require("electron"),menubar_Menu=menubar_electron.Menu,main_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):(value=result.value,value instanceof P?value:new P((function(resolve){resolve(value)}))).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},main_generator=function(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}},main_electron=require("electron"),main_app=main_electron.app,nativeTheme=main_electron.nativeTheme,path=require("path"),url=require("url"),desktopConfig=function(){if("win32"===process.platform)try{var configFile=config_fs.readFileSync("C:\\ProgramData\\ModernDeck\\config.json");try{return JSON.parse(String(configFile))}catch(e){return config_app.on("ready",(function(){config_dialog.showMessageBoxSync({type:"error",title:"ModernDeck",message:"ModernDeck detected a device config file, but an error occurred while reading it. Please ensure the JSON is free from any errors.\n\n"+e})})),{}}}catch(e){}return{}}(),main_autoUpdater=function(){switch(autoUpdater.setFeedURL({owner:"dangeredwolf",repo:"ModernDeck",provider:"github"}),desktopConfig.autoUpdatePolicy){case"disabled":case"manual":case"checkOnly":case"autoDownload":!1===desktopConfig.autoUpdateInstallOnQuit&&(autoUpdater.autoInstallOnAppQuit=!1),"autoDownload"!==desktopConfig.autoUpdatePolicy&&(autoUpdater.autoDownload=!1)}return"disabled"!==desktopConfig.autoUpdatePolicy&&"manual"!==desktopConfig.autoUpdatePolicy&&!1!==isFlatpak&&setInterval((function(){try{autoUpdater.checkForUpdates()}catch(e){console.error(e)}}),9e5),setTimeout((function(){try{"disabled"!==desktopConfig.autoUpdatePolicy&&"manual"!==desktopConfig.autoUpdatePolicy&&!0!==isFlatpak&&autoUpdater.checkForUpdates()}catch(e){console.error(e)}}),5e3),autoUpdater.on("error",(function(event,blah,blah2){getWebContents().send("error",event,blah,blah2)})),autoUpdater.on("checking-for-update",(function(event){getWebContents().send("checking-for-update",event)})),autoUpdater.on("download-progress",(function(event){getWebContents().send("download-progress",event)})),autoUpdater.on("update-available",(function(event){getWebContents().send("update-available",event)})),autoUpdater.on("update-downloaded",(function(event){getWebContents().send("update-downloaded",event)})),autoUpdater.on("update-not-available",(function(event){getWebContents().send("update-not-available",event)})),autoUpdater_ipcMain.on("checkForUpdates",(function(_event){console.log("Client requested update check"),autoUpdater&&"disabled"!==desktopConfig.autoUpdatePolicy&&!0!==isFlatpak&&autoUpdater.checkForUpdates()})),autoUpdater_ipcMain.on("downloadUpdates",(function(_event){console.log("Client requested update download"),autoUpdater&&"disabled"!==(null==desktopConfig?void 0:desktopConfig.autoUpdatePolicy)&&autoUpdater.downloadUpdate()})),autoUpdater_ipcMain.on("changeChannel",(function(_event){autoUpdater.allowPrerelease="beta"===store.get("mtd_updatechannel"),autoUpdater.channel=store.get("mtd_updatechannel")})),autoUpdater}();main_app.setAppUserModelId("com.dangeredwolf.ModernDeck");var template,menu,mtdSchemeHandler=function(request,callback){return main_awaiter(void 0,void 0,void 0,(function(){var myUrl,filePath;return main_generator(this,(function(_a){return"moderndeck://background/"===request.url?(callback({path:desktopConfig.customLoginImage}),[2]):(myUrl=new url.URL(request.url),filePath=path.join(main_electron.app.getAppPath(),"common",myUrl.hostname,myUrl.pathname),callback({path:filePath}),[2])}))}))};template=[{label:"ModernDeck",role:"appMenu",submenu:[{label:I18n("About ModernDeck"),click:function(){var _a,_b;HostManager.mainWindow&&(HostManager.mainWindow.show(),null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b||_b.send("aboutMenu"))}},{label:I18n("Check for Updates..."),click:function(){var _a,_b;HostManager.mainWindow&&(HostManager.mainWindow.show(),null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b||_b.send("checkForUpdatesMenu"))}},{type:"separator"},{label:I18n("Preferences..."),click:function(){var _a,_b;HostManager.mainWindow&&(HostManager.mainWindow.show(),null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b||_b.send("openSettings"))}},{label:I18n("Accounts..."),click:function(){var _a,_b;HostManager.mainWindow&&(HostManager.mainWindow.show(),null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b||_b.send("accountsMan"))}},{type:"separator"},{role:"services"},{type:"separator"},{role:"hide"},{role:"hideothers"},{role:"unhide"},{type:"separator"},{role:"quit"}]},{role:"fileMenu",submenu:[{label:I18n("New Tweet..."),click:function(){var _a,_b;HostManager.mainWindow&&(HostManager.mainWindow.show(),null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b||_b.send("newTweet"))}},{label:I18n("New Direct Message..."),click:function(){var _a,_b;HostManager.mainWindow&&(HostManager.mainWindow.show(),null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b||_b.send("newDM"))}},{type:"separator"},{role:"close"}]},{role:"editMenu",submenu:[{role:"undo"},{role:"redo"},{type:"separator"},{role:"cut"},{role:"copy"},{role:"paste"},{role:"delete"},{role:"selectAll"},{type:"separator"},{label:I18n("Speech"),submenu:[{role:"startspeaking"},{role:"stopspeaking"}]}]},{role:"viewMenu",submenu:[{role:"reload"},{role:"forcereload"},{type:"separator"},{role:"resetzoom"},{role:"zoomin"},{role:"zoomout"},{role:"toggledevtools"},{type:"separator"},{role:"togglefullscreen"}]},{role:"windowMenu",submenu:[{role:"minimize"},{role:"zoom"},{type:"separator"},{role:"front"},{type:"separator"},{role:"window"}]},{role:"help",submenu:[{label:I18n("Send Feedback"),click:function(){menubar_electron.shell.openExternal("https://github.com/dangeredwolf/ModernDeck/issues")}},{label:I18n("Message @ModernDeck"),click:function(){var _a,_b;HostManager.mainWindow?(HostManager.mainWindow.show(),null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b||_b.send("msgModernDeck")):menubar_electron.shell.openExternal("https://twitter.com/messages/compose?recipient_id=2927859037")}}]}],menu=menubar_Menu.buildFromTemplate(template),menubar_Menu.setApplicationMenu(menu),main_electron.protocol.registerSchemesAsPrivileged([{scheme:"moderndeck",privileges:{bypassCSP:!0,secure:!0,standard:!0,allowServiceWorkers:!0,supportFetchAPI:!0,corsEnabled:!0}}]),main_app.setAsDefaultProtocolClient("moderndeck"),main_app.on("ready",(function(){try{makeWindow(),function(desktopConfig){desktopConfig.disableDevTools&&globalShortcut.register("Control+Shift+I",(function(){})),desktopConfig.disableZoom&&(globalShortcut.register("Control+-",(function(){})),globalShortcut.register("Control+Shift+=",(function(){})))}(desktopConfig),HostManager.enableTray&&makeTray()}catch(e){console.error(e)}})),main_app.on("window-all-closed",(function(){HostManager.isRestarting||"darwin"==process.platform||main_app.quit()})),main_app.on("before-quit",(function(){HostManager.closeForReal=!0})),main_app.on("activate",(function(){null===HostManager.mainWindow&&makeWindow(),HostManager.mainWindowHidden&&HostManager.mainWindow&&HostManager.mainWindow.show&&(HostManager.mainWindow.show(),HostManager.mainWindowHidden=!1)})),main_app.on("second-instance",(function(){HostManager.mainWindow&&(HostManager.mainWindow.isMinimized()&&HostManager.mainWindow.restore(),HostManager.mainWindow.show(),HostManager.mainWindow.focus())})),nativeTheme.on("updated",(function(_event){var _a,_b;null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b||_b.send("inverted-color-scheme-changed",nativeTheme.shouldUseInvertedColorScheme)})),setTimeout((function(){var _a,_b;null===(_b=null===(_a=HostManager.mainWindow)||void 0===_a?void 0:_a.webContents)||void 0===_b||_b.send("inverted-color-scheme-changed",!!nativeTheme.shouldUseInvertedColorScheme)}),5e3)})();
//# sourceMappingURL=moderndeck-electronhost.js.map