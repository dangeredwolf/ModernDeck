{"version":3,"file":"moderndeck-electronhost.js","mappings":"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","sources":["webpack://moderndeck/webpack/bootstrap","webpack://moderndeck/./src/Settings/SettingsKey.ts","webpack://moderndeck/./src/Settings/Types/Proxy.ts","webpack://moderndeck/webpack/runtime/define property getters","webpack://moderndeck/webpack/runtime/hasOwnProperty shorthand","webpack://moderndeck/./src/Host/hostManager.ts","webpack://moderndeck/./src/Host/store.ts","webpack://moderndeck/./src/Host/utils.ts","webpack://moderndeck/./src/Host/appTag.ts","webpack://moderndeck/./src/Host/errorWindow.ts","webpack://moderndeck/./src/Host/externalLoginListener.ts","webpack://moderndeck/./src/Host/i18nMain.ts","webpack://moderndeck/./src/Host/i18n.ts","webpack://moderndeck/./src/Host/loginWindow.ts","webpack://moderndeck/./src/Host/proxy.ts","webpack://moderndeck/./src/Host/tray.ts","webpack://moderndeck/./src/Host/mainWindow.ts","webpack://moderndeck/./src/Host/autoUpdater.ts","webpack://moderndeck/./src/Host/config.ts","webpack://moderndeck/./src/Host/menubar.ts","webpack://moderndeck/./src/Host/main.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","export enum SettingsKey {\r\n    // Themes\r\n    THEME = \"mtd_theme\",\r\n    THEME_COLOR = \"mtd_color_theme\",\r\n    SELECTED_FONT = \"mtd_selectedfont\",\r\n    CUSTOM_CSS = \"mtd_customcss\",\r\n\r\n    // Appearance\r\n    NAVIGATION_STYLE = \"mtd_headposition\",\r\n    FIXED_ARROWS = \"mtd_usefixedarrows\",\r\n    ENABLE_NEW_TWEETS_BUTTON = \"mtd_nonewtweetsbutton\",\r\n    ENABLE_EMOJI_PICKER = \"mtd_noemojipicker\",\r\n    KEEP_MODALS_OPEN = \"mtd_modalKeepOpen\",\r\n    BLUR_MESSAGES = \"mtd_hideMessages\",\r\n    THREAD_INDICATOR = \"mtd_threadIndicator\",\r\n    ALT_SENSITIVE = \"mtd_sensitive_alt\",\r\n    SCROLLBAR_STYLE = \"mtd_scrollbar_style\",\r\n    COLUMN_WIDTH = \"mtd_columnwidth\",\r\n    FONT_SIZE = \"mtd_fontsize\",\r\n    AVATAR_SIZE = \"mtd_avatarsize\",\r\n    ROUND_AVATARS = \"mtd_round_avatars\",\r\n    DISABLE_AVATARS = \"mtd_disable_avatars\",\r\n    NEW_CHARACTER_INDICATOR = \"mtd_newcharindicator\",\r\n    CONTEXT_MENU_ICONS = \"mtd_nocontextmenuicons\",\r\n\r\n    // Tweets\r\n    COLUMN_VISIBILITY = \"mtd_column_visibility\",\r\n    MODERNDECK_ALERT_SOUND = \"mtd_sounds\",\r\n    NFT_AUTO_ACTION = \"mtd_nftAvatarAction\",\r\n    NFT_ACTION_NOTIFY = \"mtd_nftNotify\",\r\n    NFT_DONT_BLOCK_FOLLOWING = \"mtd_nftDontBlockFollowing\",\r\n\r\n    // Accessibility\r\n    FOCUS_OUTLINES = \"mtd_outlines\",\r\n    HIGH_CONTRAST = \"mtd_highcontrast\",\r\n\r\n    // App\r\n    NATIVE_TITLE_BAR = \"mtd_nativetitlebar\",\r\n    NATIVE_EMOJI = \"mtd_nativeEmoji\",\r\n    NATIVE_CONTEXT_MENUS = \"mtd_nativecontextmenus\",\r\n    UPDATE_CHANNEL = \"mtd_updatechannel\",\r\n    TRAY_ENABLED = \"mtd_systemtray\",\r\n    BACKGROUND_NOTIFICATIONS = \"mtd_background\",\r\n    INSPECT_ELEMENT = \"mtd_inspectElement\",\r\n    PROXY_MODE = \"mtd_proxy_mode\",\r\n    PROXY_PAC_SCRIPT = \"mtd_proxy_pac_script\",\r\n    PROXY_RULES = \"mtd_proxy_rules\",\r\n    PROXY_SERVERS = \"mtd_proxy_server_list\",\r\n\r\n    // Language\r\n    LANGUAGE = \"mtd_lang\",\r\n    LAST_LANGUAGE = \"mtd_last_lang\",\r\n    TIME_FORMAT = \"mtd_timeFormat\",\r\n    NUMBER_FORMAT = \"mtd_shortDateFormat\",\r\n    ABBREV_NUMBERS = \"mtd_abbrevNumbers\",\r\n\r\n    // Internal Settings\r\n    COLLAPSED_COLUMNS = \"mtd_collapsed_columns\",\r\n    LAST_VERSION = \"mtd_last_version\",\r\n    REPLACE_FAVICON = \"mtd_replace_favicon\",\r\n\r\n    // Internal values not used in Internal Settings framework\r\n    NFT_ACTION_QUEUE = \"mtd_nftActionQueue\",\r\n\r\n    // Main process stuff\r\n    FULL_SCREEN = \"mtd_fullscreen\",\r\n    MAXIMIZED = \"mtd_maximised\",\r\n    WINDOW_BOUNDS = \"mtd_windowBounds\",\r\n    LAST_DISPLAY = \"mtd_usedDisplay\",\r\n    SAFE_MODE = \"mtd_safemode\",\r\n    WELCOMED_10 = \"mtd_welcomed10\",\r\n    WELCOMED = \"mtd_welcomed\",\r\n\r\n    // Currently unused\r\n    MUTE_CATCHES = \"mtd_mute_catches\",\r\n    SYNC_ENABLED = \"mtd_sync_enabled\",\r\n    SYNC_LAST_UPDATED = \"mtd_sync_last_updated\",\r\n}","export enum ProxyMode {\r\n    AUTODETECT = \"autodetect\",\r\n    MANUAL = \"manual\",\r\n    PAC = \"pac\",\r\n    DIRECT = \"direct\"\r\n}\r\n\r\nexport enum ManualProxyType {\r\n    HTTP = \"http\",\r\n    HTTPS = \"https\",\r\n    SOCKS4 = \"socks4\",\r\n    SOCKS5 = \"socks5\"\r\n}","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","export class HostManager {\r\n    static mainWindow: Electron.BrowserWindow = null;\r\n    static errorWindow: Electron.BrowserWindow = null;\r\n    static loginWindow: Electron.BrowserWindow = null;\r\n    static tray: Electron.Tray = null;\r\n\r\n    static shouldQuitIfErrorClosed: boolean = false;\r\n    static closeForReal: boolean = false;\r\n    static mainWindowHidden: boolean = false;\r\n    static enableTray: boolean = true;\r\n    static enableBackground: boolean = true;\r\n    static isRestarting: boolean = false;\r\n}","const Store = require(\"electron-store\");\r\nexport const store = new Store({name:\"mtdsettings\"});","export const separator = process.platform === \"win32\" ? \"\\\\\" : \"/\";\r\nexport const isAppX = !!process.windowsStore\r\nexport const isFlatpak = (process.platform === \"linux\" && process.env.FLATPAK_HOST === \"1\")\r\nexport const isMAS = !!process.mas;\r\n\r\nconst https = require(\"https\");\r\nconst fs = require(\"fs\");\r\nconst { dialog } = require(\"electron\");\r\n\r\nexport function saveImageAs(url: string) {\r\n\tif (!url) {\r\n\t\tthrow \"saveImageAs requires \\\"URL\\\" as an argument\";\r\n\t}\r\n\r\n\tlet fileType = url.match(/(?<=format=)(\\w{3,4})|(?<=\\.)(\\w{3,4}(?=\\?))/g)[0] || \"file\";\r\n\tlet fileName = url.match(/(?<=media\\/)[\\w\\d_\\-]+|[\\w\\d_\\-]+(?=\\.m)/g)[0] || \"jpg\";\r\n\r\n\t// console.log(\"saveImageAs\");\r\n\r\n\tlet savePath = dialog.showSaveDialogSync({defaultPath:fileName + \".\" + fileType});\r\n\t// console.log(savePath);\r\n\tif (savePath) {\r\n\t\ttry {\r\n\r\n\t\t\tconst file = fs.createWriteStream(savePath);\r\n\r\n\t\t\thttps.get(url, (response: any) => {\r\n\t\t\t\t// console.log(\"Piping file...\");\r\n\t\t\t\tresponse.pipe(file);\r\n\t\t\t});\r\n\t\t} catch(e) {\r\n\t\t\tconsole.log(e);\r\n\t\t}\r\n\t}\r\n\r\n};","import { SettingsKey } from \"../Settings/SettingsKey\";\r\nimport { HostManager } from \"./hostManager\";\r\nimport { store } from \"./store\";\r\nimport { isAppX, isFlatpak, isMAS } from \"./utils\";\r\n\r\nconst { app } = require(\"electron\");\r\n\r\nlet mtdAppTag = '';\r\n\r\n// App tags control browser behavior like CSS layouts and sometimes JS\r\nexport function updateAppTag() {\r\n\tHostManager.mainWindow?.webContents?.executeJavaScript('document.querySelector(\"html\").classList.remove(\"mtd-app\");\\\r\n\t\tdocument.querySelector(\"html\").classList.remove(\"mtd-app-win\");\\\r\n\t\tdocument.querySelector(\"html\").classList.remove(\"mtd-app-mac\");\\\r\n\t\tdocument.querySelector(\"html\").classList.remove(\"mtd-app-linux\");\\\r\n\t');\r\n\r\n\t// Here, we add platform-specific tags to html, to help moderndeck CSS know what to do\r\n\r\n\tmtdAppTag = 'document.querySelector(\"html\").classList.add(\"mtd-js-app\");\\n';\r\n\r\n\tif (isAppX) {\r\n\t\tmtdAppTag += 'document.querySelector(\"html\").classList.add(\"mtd-winstore\");\\n';\r\n\t}\r\n\r\n\tif (isFlatpak) {\r\n\t\tmtdAppTag += 'document.querySelector(\"html\").classList.add(\"mtd-flatpak\");\\n';\r\n\t}\r\n\r\n\tif (isMAS) {\r\n\t\tmtdAppTag += 'document.querySelector(\"html\").classList.add(\"mtd-macappstore\");\\n';\r\n\t}\r\n\r\n\tif (app.isEmojiPanelSupported()) {\r\n\t\tmtdAppTag += 'document.querySelector(\"html\").classList.add(\"mtd-supportsNativeEmojiPicker\");\\n';\r\n\t}\r\n\r\n\tif (!store.get(SettingsKey.NATIVE_TITLE_BAR)) {\r\n\r\n\t\tmtdAppTag += 'document.querySelector(\"html\").classList.add(\"mtd-app\");\\n';\r\n\r\n\t\tif (process.platform === \"darwin\") {\r\n\t\t\tmtdAppTag += 'document.querySelector(\"html\").classList.add(\"mtd-app-mac\");\\n'\r\n\t\t}\r\n\r\n\t\tif (process.platform === \"linux\") {\r\n\t\t\tmtdAppTag += 'document.querySelector(\"html\").classList.add(\"mtd-app-linux\");\\n'\r\n\t\t}\r\n\r\n\t\tif (process.platform === \"win32\") {\r\n\t\t\tmtdAppTag += 'document.querySelector(\"html\").classList.add(\"mtd-app-win\");\\n'\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tHostManager.mainWindow?.webContents?.executeJavaScript(\r\n\t\t(store.get(SettingsKey.FULL_SCREEN) ? 'document.querySelector(\"html\").classList.add(\"mtd-js-app\");' : mtdAppTag)\r\n\t)\r\n}\r\n","import { separator } from \"./utils\";\r\nimport { HostManager } from \"./hostManager\";\r\n\r\nconst electron = require(\"electron\");\r\nconst { app, BrowserWindow, shell } = electron;\r\n\r\nexport function makeErrorWindow() {\r\n\r\n\tshell.beep();\r\n\r\n\tHostManager.errorWindow = new BrowserWindow({\r\n\t\twidth: 600,\r\n\t\theight: 260,\r\n\t\twebPreferences: {\r\n\t\t\tscrollBounce: true,\r\n\t\t\tcontextIsolation: false,\r\n\t\t\tnodeIntegration: true\r\n\t\t},\r\n\t\tparent:HostManager.mainWindow,\r\n\t\tautoHideMenuBar:true\r\n\t});\r\n\r\n\tHostManager.shouldQuitIfErrorClosed = true;\r\n\r\n\tHostManager.errorWindow.webContents.on(\"new-window\", (event: Event, url: string) => {\r\n\t\tevent.preventDefault();\r\n\t\tshell.openExternal(url);\r\n\t});\r\n\r\n\tHostManager.errorWindow.on(\"closed\", () => {\r\n\t\tHostManager.errorWindow = null;\r\n\t\tif (HostManager.shouldQuitIfErrorClosed) {\r\n\t\t\tapp.quit();\r\n\t\t}\r\n\t});\r\n\r\n\tHostManager.errorWindow.loadURL(`file://${__dirname}${separator}..${separator}..${separator}..${separator}sadmoderndeck.html`);\r\n\r\n\tHostManager.errorWindow.webContents.on(\"did-start-navigation\", (event, url) => {\r\n\t\tevent.preventDefault();\r\n\t});\r\n\r\n\r\n}","const { WebSocketServer } = require('ws');\r\n\r\nlet beganServer = false;\r\n\r\nexport const startExternalLoginServer = () => {\r\n\r\n\tif (beganServer) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tbeganServer = true;\r\n\t\r\n\tconsole.log(\"Beginning websocket connection...\");\r\n\r\n\tconst wss = new WebSocketServer({ host: \"127.0.0.1\", port: 13325 });\r\n\r\n\twss.on('connection', function connection(ws: any, req: any) {\r\n\t\tif (req.headers.origin !== \"https://tweetdeck.twitter.com\") {\r\n\t\t\tconsole.log(\"Connection from invalid origin\");\r\n\t\t\tconsole.log(req);\r\n\t\t\tws.close();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tws.on('message', function message(data: Buffer) {\r\n\t\t\tif (String(data) === \"HELLO\") {\r\n\t\t\t\tws.send(\"READY\");\r\n\t\t\t}\r\n\t\t\tconsole.log('received: %s', data);\r\n\t\t});\r\n\t});\r\n}","export default {\"Check for Updates...\":{\"zh_CN\":\"检查更新...\",\"zh_TW\":\"檢查更新…\",\"da\":\"Tjek for opdateringer...\",\"en_CA\":\"Check for Updates...\",\"en_GB\":\"Check for Updates...\",\"en_US\":\"Check for Updates...\",\"et\":\"Otsi värskendusi...\",\"fr\":\"Rechercher des mises à jour...\",\"fr_CA\":\"Rechercher des mises à jour...\",\"de\":\"Nach Updates suchen...\",\"hu\":\"Frissítés keresése...\",\"it\":\"Controlla gli Aggiornamenti...\",\"ja\":\"アップデートを確認する\",\"ko\":\"업데이트 확인...\",\"no\":\"Se etter oppdateringer...\",\"pl\":\"Sprawdź aktualizacje...\",\"pt\":\"Verificar se há atualizações...\",\"ru\":\"Проверить обновления...\",\"es\":\"Buscar Actualizaciones...\",\"es_AR\":\"Buscar Actualizaciones...\",\"es_419\":\"Buscar Actualizaciones...\",\"es_US\":\"Buscar Actualizaciones...\",\"uk\":\"Перевірити оновлення...\",\"si\":\"යාවත්කාලීනයන් සඳහා පිරික්සන්න\",\"sl\":\"Preveri za posodobitve...\",\"id\":\"Periksa Pembaruan...\"},\"Preferences...\":{\"zh_CN\":\"首选项\",\"zh_TW\":\"偏好設定…\",\"da\":\"Indstillinger...\",\"en_CA\":\"Preferences...\",\"en_GB\":\"Preferences...\",\"en_US\":\"Preferences...\",\"et\":\"Eelistused...\",\"fr\":\"Paramètres...\",\"fr_CA\":\"Paramètres...\",\"de\":\"Einstellungen...\",\"hu\":\"Beállítások...\",\"it\":\"Preferenze...\",\"ja\":\"設定\",\"ko\":\"설정...\",\"no\":\"Innstillinger...\",\"pl\":\"Preferencje...\",\"pt\":\"Preferências...\",\"ru\":\"Настройки...\",\"es\":\"Preferencias...\",\"es_AR\":\"Preferencias...\",\"es_419\":\"Preferencias...\",\"es_US\":\"Preferencias...\",\"uk\":\"Налаштування...\",\"sl\":\"&Nastavitve...\",\"id\":\"Pilihan...\"},\"Accounts...\":{\"zh_CN\":\"帐户\",\"zh_TW\":\"帳戶…\",\"da\":\"Konti...\",\"en_CA\":\"Accounts...\",\"en_GB\":\"Accounts...\",\"en_US\":\"Accounts...\",\"et\":\"Kontod...\",\"fr\":\"Comptes...\",\"fr_CA\":\"Comptes...\",\"de\":\"Accounts...\",\"hu\":\"Fiókok...\",\"it\":\"Account...\",\"ja\":\"アカウント\",\"ko\":\"계정...\",\"no\":\"Kontoer...\",\"pl\":\"Konta...\",\"pt\":\"Contas...\",\"ru\":\"Аккаунты...\",\"es\":\"Cuentas...\",\"es_AR\":\"Cuentas...\",\"es_419\":\"Cuentas...\",\"es_US\":\"Cuentas...\",\"uk\":\"Облікові записи...\",\"si\":\"ගිණුම්...\",\"sl\":\"Računi...\",\"id\":\"Akun...\"},\"New Direct Message...\":{\"zh_CN\":\"发送新的私信...\",\"zh_TW\":\"傳送新訊息\",\"da\":\"Ny besked...\",\"en_CA\":\"New Direct Message...\",\"en_GB\":\"New Direct Message...\",\"en_US\":\"New Direct Message...\",\"et\":\"Saada sõnum...\",\"fr\":\"Nouveau message privé...\",\"fr_CA\":\"Nouveau message privé...\",\"de\":\"Neue Privatnachricht...\",\"hu\":\"Új privát üzenet...\",\"it\":\"Nuovo messaggio diretto...\",\"ja\":\"ダイレクトメッセージを作成\",\"ko\":\"새 쪽지 보내기...\",\"no\":\"Ny direktemelding...\",\"pl\":\"Nowa Bezpośrednia Wiadomość...\",\"pt\":\"Nova mensagem direta...\",\"ru\":\"Новое личное сообщение...\",\"es\":\"Nuevo mensaje directo...\",\"es_AR\":\"Nuevo mensaje directo...\",\"es_419\":\"Nuevo mensaje directo...\",\"es_US\":\"Nuevo mensaje directo...\",\"uk\":\"Нове особисте повідомлення...\",\"sl\":\"Novo direktno sporočilo...\",\"id\":\"Pesan Langsung Baru...\"},\"Speech\":{\"zh_CN\":\"语音\",\"zh_TW\":\"語音\",\"da\":\"Tale\",\"en_CA\":\"Speech\",\"en_GB\":\"Speech\",\"en_US\":\"Speech\",\"et\":\"Kõne\",\"fr\":\"Fonction vocale\",\"fr_CA\":\"Fonction vocale\",\"de\":\"Spracheingabe\",\"hu\":\"Felolvasás\",\"it\":\"Voce\",\"ja\":\"読み上げ\",\"ko\":\"스피치\",\"no\":\"Tale\",\"pl\":\"Mowa\",\"pt\":\"Voz\",\"ru\":\"Речь\",\"es\":\"Voz\",\"es_AR\":\"Voz\",\"es_419\":\"Voz\",\"es_US\":\"Voz\",\"uk\":\"Мовлення\",\"sl\":\"Govor\"},\"Send Feedback\":{\"zh_CN\":\"意见反馈\",\"zh_TW\":\"意見回饋\",\"da\":\"Send Feedback\",\"en_CA\":\"Send Feedback\",\"en_GB\":\"Send Feedback\",\"en_US\":\"Send Feedback\",\"et\":\"Saada tagasiside\",\"fr\":\"Envoyer votre avis\",\"fr_CA\":\"Envoyer votre avis\",\"de\":\"Feedback geben\",\"hu\":\"Visszajelzés küldése\",\"it\":\"Invia Feedback\",\"ja\":\"フィードバックを送る\",\"ko\":\"피드백 보내기\",\"no\":\"Send Tilbakemelding\",\"pl\":\"Wyślij opinię\",\"pt\":\"Enviar Feedback\",\"ru\":\"Отправить отзыв\",\"es\":\"Enviar Comentarios\",\"es_AR\":\"Enviar Comentarios\",\"es_419\":\"Enviar Comentarios\",\"es_US\":\"Enviar Comentarios\",\"uk\":\"Надіслати відгук\",\"sl\":\"Pošlji povratne informacije\",\"id\":\"Kirim Umpan Balik\"},\"Message @ModernDeck\":{\"zh_CN\":\"私信@ModernDeck\",\"zh_TW\":\"訊息@ModernDeck\",\"da\":\"Skriv til @ModernDeck\",\"en_CA\":\"Message @ModernDeck\",\"en_GB\":\"Message @ModernDeck\",\"en_US\":\"Message @ModernDeck\",\"et\":\"Kirjuta @ModernDeck'ile\",\"fr\":\"Envoyer un message à @ModernDeck\",\"fr_CA\":\"Envoyer un message à @ModernDeck\",\"de\":\"Nachricht an @ModernDeck\",\"hu\":\"Üzenet küldése @ModernDeck-nek\",\"it\":\"Messaggio @ModernDeck\",\"ja\":\"@ModernDeck にメッセージ\",\"ko\":\"@ModernDeck에게 메세지 보내기\",\"no\":\"Send en Melding til @ModernDeck\",\"pl\":\"Wyślij wiadomość do @ModernDeck\",\"pt\":\"Mensagem @ModernDeck\",\"ru\":\"Написать @ModernDeck\",\"es\":\"Mensajea @ModernDeck\",\"es_AR\":\"Mensajea @ModernDeck\",\"es_419\":\"Mensajea @ModernDeck\",\"es_US\":\"Mensajea @ModernDeck\",\"uk\":\"Написати @ModernDeck\",\"sl\":\"Kontaktiraj @ModernDeck\"},\"Updates might not work correctly if you aren't running ModernDeck from the Applications folder.\\n\\nWould you like to move it there?\":{\"zh_CN\":\"如果您没有从应用程序文件夹运行ModernDeck，您安装的更新可能无法正常工作。\\n\\n您想要把ModernDeck移动至那里吗？\",\"zh_TW\":\"如果您沒有從應用程式資料夾運行ModernDeck，您安裝的更新可能無法正常工作。 \\n\\n您想要把ModernDeck移動至那裡嗎？\",\"da\":\"Opdateringer fungerer muligvis ikke korrekt, hvis du ikke kører ModernDeck fra mappen Programmer.\\n\\nVil du flytte programmet der til?\",\"en_CA\":\"Updates might not work correctly if you aren't running ModernDeck from the Applications folder.\\n\\nWould you like to move it there?\",\"en_GB\":\"Updates might not work correctly if you aren't running ModernDeck from the Applications folder.\\n\\nWould you like to move it there?\",\"en_US\":\"Updates might not work correctly if you aren't running ModernDeck from the Applications folder.\\n\\nWould you like to move it there?\",\"et\":\"Värskendused ei pruugi õigesti töötada kui te ei käivita ModernDeck'i rakenduste kaustast.\\n\\nKas sooviksite selle sinna teisendada?\",\"fr\":\"Les mises à jour pourraient ne pas fonctionner correctement si vous n'exécutez pas ModernDeck depuis le dossier Applications.\\n\\nVoulez-vous le déplacer dans ce dossier?\",\"fr_CA\":\"Les mises à jour pourraient ne pas fonctionner correctement si vous n'exécutez pas ModernDeck depuis le dossier Applications.\\n\\nVoulez-vous le déplacer dans ce dossier?\",\"de\":\"Updates funktionieren möglicherweise nicht korrekt wenn ModernDeck außerhalb des Programmordners gestartet wird.\\n\\nMöchtest Du ModernDeck in den Programmordner verschieben?\",\"hu\":\"A frissítés nem történhet megfelelően, ha a ModernDecket nem az Alkalmazások mappából futtatod.\\n\\nSzeretnéd oda mozgatni az alkalmazást?\",\"it\":\"Gli aggiornamenti potrebbero non funzionare correttamente se non stai usando ModernDeck dalla cartella Applicazioni.\\n\\nVuoi spostarlo lì?\",\"ja\":\"ApplicationsフォルダからModernDeckを実行していない場合、正常にアップデートできない可能性があります。\\n\\nそこに移動しますか？\",\"ko\":\"ModernDeck을 애플리케이션 폴더에서 실행하지 않으면 업데이트가 제대로 동작하지 않을 수 있습니다.\\n\\n지금 바로 옮길까요?\",\"no\":\"Oppdateringer vil kanskje ikke virke som de skal hvis du ikke kjører ModernDeck fra Programmer-mappen.\\n\\nVil du flytte den dit?\",\"pl\":\"Aktualizacje mogą działać niepoprawnie jeżeli nie korzystasz z ModernDeck z folderu Aplikacje.\\n\\nCzy chcesz to przenieść?\",\"pt\":\"As atualizações podem não funcionar corretamente se não estiver a executar o ModernDeck a partir da pasta Aplicações.\\n\\nGostaria de movê-lo para lá?\",\"ru\":\"Обновления могут работать неправильно, если ModernDeck не находится в папке Программы.\\n\\nХотите перенести его туда?\",\"es\":\"Es posible que las actualizaciones no funcionen correctamente si no estás ejecutando ModernDeck desde la carpeta de Aplicaciones.\\n\\n¿Deseas moverla ahí?\",\"es_AR\":\"Es posible que las actualizaciones no funcionen correctamente si no estás ejecutando ModernDeck desde la carpeta de Aplicaciones.\\n\\n¿Deseas moverla ahí?\",\"es_419\":\"Es posible que las actualizaciones no funcionen correctamente si no estás ejecutando ModernDeck desde la carpeta de Aplicaciones.\\n\\n¿Deseas moverla ahí?\",\"es_US\":\"Es posible que las actualizaciones no funcionen correctamente si no estás ejecutando ModernDeck desde la carpeta de Aplicaciones.\\n\\n¿Deseas moverla ahí?\",\"uk\":\"Оновлення можуть працювати неправильно, якщо ви не використовуєте ModernDeck з системної теки Applications.\\n\\nХочете перемістити його до неї?\",\"sl\":\"Posodobitve mogoče ne bodo delovale pravilo, če ne zaganjate ModernDeck iz Applications mape. \\n\\n Ali jo želite prestaviti tja?\",\"id\":\"Pembaruan mungkin tidak berjalan dengan benar jika ModernDeck tidak dijalankan dari folder Applications.\\n\\nPindahkan ke sini?\"},\"Not Now\":{\"zh_CN\":\"暂时不要\",\"zh_TW\":\"不是現在\",\"da\":\"Ikke Nu\",\"en_CA\":\"Not Now\",\"en_GB\":\"Not Now\",\"en_US\":\"Not Now\",\"et\":\"Mitte preagu\",\"fr\":\"Pas maintenant\",\"fr_CA\":\"Pas maintenant\",\"de\":\"Nicht jetzt\",\"hu\":\"Most nem\",\"it\":\"Non Adesso\",\"ja\":\"今はしない\",\"ko\":\"나중에 하기\",\"no\":\"Ikke Nå\",\"pl\":\"Nie Teraz\",\"pt\":\"Agora não\",\"ru\":\"Не сейчас\",\"es\":\"Ahora no\",\"es_AR\":\"Ahora no\",\"es_419\":\"Ahora no\",\"es_US\":\"Ahora no\",\"uk\":\"Не зараз\",\"si\":\"දැන් නොවේ\",\"sl\":\"Ne zdaj\",\"id\":\"Jangan Sekarang\"},\"Yes, Move It\":{\"zh_CN\":\"是的，移动它\",\"zh_TW\":\"好的，移動他\",\"da\":\"Ja, flyt den\",\"en_CA\":\"Yes, Move It\",\"en_GB\":\"Yes, Move It\",\"en_US\":\"Yes, Move It\",\"et\":\"Jah, teisenda\",\"fr\":\"Oui, déplacer\",\"fr_CA\":\"Oui, déplacer\",\"de\":\"Ja, verschieben\",\"hu\":\"Igen\",\"it\":\"Sì, Sposta\",\"ja\":\"移動する\",\"ko\":\"지금 옮기기\",\"no\":\"Ja, Flytt Den\",\"pl\":\"Tak, Przenieś\",\"pt\":\"Sim, Mover\",\"ru\":\"Переместить\",\"es\":\"Sí, moverlo\",\"es_AR\":\"Sí, moverlo\",\"es_419\":\"Sí, moverlo\",\"es_US\":\"Sí, moverlo\",\"uk\":\"Перемістити\",\"sl\":\"Da, prestavi\",\"id\":\"Ya, Pindahkan\"},\"We couldn't automatically move ModernDeck to the applications folder. You may need to move it yourself.\":{\"zh_CN\":\"我们不能自动将ModernDeck移动到应用程序文件夹。您可能需要自己移动它。\",\"zh_TW\":\"我們無法自動將ModernDeck移動到應用程式資料夾。您可能需要自己移動它。\",\"da\":\"Vi kunne ikke automatisk flytte ModernDeck til mappen programmer. Du skal muligvis selv flytte den.\",\"en_CA\":\"We couldn't automatically move ModernDeck to the applications folder. You may need to move it yourself.\",\"en_GB\":\"We couldn't automatically move ModernDeck to the applications folder. You may need to move it yourself.\",\"en_US\":\"We couldn't automatically move ModernDeck to the applications folder. You may need to move it yourself.\",\"et\":\"Me ei saanud ModernDeck'i automaatselt rakenduste kausta teisendada. Võimalusel peate selle ise teisendama.\",\"fr\":\"Nous n'avons pas pu déplacer automatiquement ModernDeck dans le dossier des applications. Vous devrez peut-être le déplacer vous-même.\",\"fr_CA\":\"Nous n'avons pas pu déplacer automatiquement ModernDeck dans le dossier des applications. Vous devrez peut-être le déplacer vous-même.\",\"de\":\"ModernDeck konnte nicht automatisch in den Programmordner verschoben werden. Möglicherweise musst du das selber tun.\",\"hu\":\"Nem sikerült a ModernDecket automatikusan átmozgatni az Alkalmazások mappába. Lehet, hogy kézzel kell megtenned.\",\"it\":\"Non siamo riusciti a spostare ModernDeck automaticamente nella cartella applicazioni. Potresti doverlo spostare manualmente.\",\"ja\":\"ModernDeck をアプリケーションフォルダに移動できませんでした。手動で移動する必要があるかもしれません。\",\"ko\":\"ModernDeck을 응용 프로그램 폴더로 이동할수 없었습니다. 직접 이동해야 할 수 있습니다.\",\"no\":\"Vi kunne ikke automatisk flytte ModernDeck til Programmer-mappen. Du må kanskje flytte den selv.\",\"pl\":\"Nie mogliśmy przenieść ModernDeck to folderu Aplikacje. Może być konieczne samodzielne przeniesienie.\",\"pt\":\"Não foi possível mover automaticamente o ModernDeck para a pasta de aplicações. Pode ser preciso movê-lo manualmente.\",\"ru\":\"Мы не смогли автоматически переместить ModernDeck в папку Программы. Возможно, вам придётся переместить его самостоятельно.\",\"es\":\"No hemos podido mover ModernDeck a la carpeta de Aplicaciones. Es posible que tengas que moverla tú.\",\"es_AR\":\"No hemos podido mover ModernDeck a la carpeta de Aplicaciones. Es posible que tengas que moverla tú.\",\"es_419\":\"No hemos podido mover ModernDeck a la carpeta de Aplicaciones. Es posible que tengas que moverla tú.\",\"es_US\":\"No hemos podido mover ModernDeck a la carpeta de Aplicaciones. Es posible que tengas que moverla tú.\",\"uk\":\"Ми не змогли автоматично перемістити ModernDeck до системної теки Applications. Можливо, Вам доведеться зробити це самостійно.\",\"sl\":\"Avtomatski premik ModernDeck v Applications mapo ni uspel. Premaknite jo sami.\"},\"OK\":{\"zh_CN\":\"好的\",\"zh_TW\":\"確定\",\"da\":\"OK\",\"en_CA\":\"OK\",\"en_GB\":\"OK\",\"en_US\":\"OK\",\"et\":\"OK\",\"fr\":\"OK\",\"fr_CA\":\"OK\",\"de\":\"OK\",\"hu\":\"OK\",\"it\":\"OK\",\"ja\":\"OK\",\"ko\":\"확인\",\"no\":\"OK\",\"pl\":\"OK\",\"pt\":\"Ok\",\"ru\":\"ОК\",\"es\":\"Aceptar\",\"es_AR\":\"Aceptar\",\"es_419\":\"Aceptar\",\"es_US\":\"Aceptar\",\"uk\":\"OK\",\"si\":\"හරි\",\"sl\":\"Vredu\",\"id\":\"Oke\"},\"Retry\":{\"zh_CN\":\"重试\",\"zh_TW\":\"重試\",\"da\":\"Prøv igen\",\"en_CA\":\"Retry\",\"en_GB\":\"Retry\",\"en_US\":\"Retry\",\"et\":\"Proovi uuesti\",\"fr\":\"Réessayer\",\"fr_CA\":\"Réessayer\",\"de\":\"Erneut versuchen\",\"hu\":\"Újra\",\"it\":\"Riprova\",\"ja\":\"再試行\",\"ko\":\"재시도\",\"no\":\"Prøv igjen\",\"pl\":\"Ponów próbę\",\"pt\":\"Tentar novamente\",\"ru\":\"Попробовать ещё\",\"es\":\"Reintentar\",\"es_AR\":\"Reintentar\",\"es_419\":\"Reintentar\",\"es_US\":\"Reintentar\",\"uk\":\"Повторити\",\"si\":\"නැවත උත්සාහ කරන්න\",\"sl\":\"Poizkusi znova\",\"id\":\"Coba lagi\"},\"Close\":{\"zh_CN\":\"关闭\",\"zh_TW\":\"關閉​​​\",\"da\":\"Luk\",\"en_CA\":\"Close\",\"en_GB\":\"Close\",\"en_US\":\"Close\",\"et\":\"Sulge\",\"fr\":\"Fermer\",\"fr_CA\":\"Fermer\",\"de\":\"Schließen\",\"hu\":\"Bezárás\",\"it\":\"Chiudi\",\"ja\":\"閉じる\",\"ko\":\"닫기\",\"no\":\"Lukk\",\"pl\":\"Zamknij\",\"pt\":\"Fechar\",\"ru\":\"Закрыть\",\"es\":\"Cerrar\",\"es_AR\":\"Cerrar\",\"es_419\":\"Cerrar\",\"es_US\":\"Cerrar\",\"uk\":\"Закрити\",\"si\":\"වසන්න\",\"sl\":\"Zapri\",\"id\":\"Tutup\"},\"About ModernDeck\":{\"zh_CN\":\"关于 ModernDeck\",\"zh_TW\":\"關於 ModernDeck\",\"da\":\"Om ModernDeck\",\"en_CA\":\"About ModernDeck\",\"en_GB\":\"About ModernDeck\",\"en_US\":\"About ModernDeck\",\"et\":\"ModernDeck'i teave\",\"fr\":\"À propos de ModernDeck\",\"fr_CA\":\"À propos de ModernDeck\",\"de\":\"Über ModernDeck\",\"hu\":\"A ModernDeck névjegye\",\"it\":\"Informazioni Su ModernDeck\",\"ja\":\"ModernDeck について\",\"ko\":\"ModernDeck 정보\",\"no\":\"Om ModernDeck\",\"pl\":\"O ModernDeck\",\"pt\":\"Sobre o ModernDeck\",\"ru\":\"О ModernDeck\",\"es\":\"Acerca de ModernDeck\",\"es_AR\":\"Acerca de ModernDeck\",\"es_419\":\"Acerca de ModernDeck\",\"es_US\":\"Acerca de ModernDeck\",\"uk\":\"Про ModernDeck\",\"sl\":\"O ModernDeck\",\"id\":\"Tentang ModernDeck\"},\"New Tweet...\":{\"zh_CN\":\"新推文\",\"zh_TW\":\"新推文…\",\"da\":\"Nyt Tweet...\",\"en_CA\":\"New Tweet...\",\"en_GB\":\"New Tweet...\",\"en_US\":\"New Tweet...\",\"et\":\"Uus säuts...\",\"fr\":\"Nouveau Tweet...\",\"fr_CA\":\"Nouveau Tweet...\",\"de\":\"Neuer Tweet...\",\"hu\":\"Új Tweet...\",\"it\":\"Nuovo Tweet...\",\"ja\":\"ツイートを作成\",\"ko\":\"새 트윗 보내기...\",\"no\":\"Ny tweet...\",\"pl\":\"Nowy Tweet...\",\"pt\":\"Novo Tweet...\",\"ru\":\"Новый твит...\",\"es\":\"Nuevo Tweet...\",\"es_AR\":\"Nuevo Tweet...\",\"es_419\":\"Nuevo Tweet...\",\"es_US\":\"Nuevo Tweet...\",\"uk\":\"Створити Твіт...\",\"sl\":\"Nov Tweet...\",\"id\":\"Tweet Baru...\"},\"Open ModernDeck\":{\"zh_CN\":\"启动 ModernDeck\",\"zh_TW\":\"開啟 ModernDeck\",\"da\":\"Åbn ModernDeck\",\"en_CA\":\"Open ModernDeck\",\"en_GB\":\"Open ModernDeck\",\"en_US\":\"Open ModernDeck\",\"et\":\"Ava ModernDeck\",\"fr\":\"Ouvrir ModernDeck\",\"fr_CA\":\"Ouvrir ModernDeck\",\"de\":\"ModernDeck öffnen\",\"hu\":\"ModernDeck megnyitása\",\"it\":\"Apri ModernDeck\",\"ja\":\"ModernDeckを開く\",\"ko\":\"ModernDeck 열기\",\"no\":\"Åpne ModernDeck\",\"pl\":\"Otwórz ModernDeck\",\"pt\":\"Abrir ModernDeck\",\"ru\":\"Открыть ModernDeck\",\"es\":\"Abrir ModernDeck\",\"es_AR\":\"Abrir ModernDeck\",\"es_419\":\"Abrir ModernDeck\",\"es_US\":\"Abrir ModernDeck\",\"uk\":\"Відкрити ModernDeck\",\"sl\":\"Odpri ModernDeck\",\"id\":\"Buka ModernDeck\"},\"Settings...\":{\"zh_CN\":\"设置...\",\"zh_TW\":\"設定…\",\"da\":\"Indstillinger...\",\"en_CA\":\"Settings...\",\"en_GB\":\"Settings...\",\"en_US\":\"Settings...\",\"et\":\"Seaded...\",\"fr\":\"Paramètres...\",\"fr_CA\":\"Paramètres...\",\"de\":\"Einstellungen...\",\"hu\":\"Beállítások...\",\"it\":\"Impostazioni...\",\"ja\":\"設定\",\"ko\":\"설정...\",\"no\":\"Innstillinger...\",\"pl\":\"Ustawienia...\",\"pt\":\"Configurações...\",\"ru\":\"Настройки...\",\"es\":\"Ajustes...\",\"es_AR\":\"Ajustes...\",\"es_419\":\"Ajustes...\",\"es_US\":\"Ajustes...\",\"uk\":\"Налаштування...\",\"si\":\"සැකසුම්...\",\"sl\":\"Nastavitve...\",\"id\":\"Pengaturan...\"},\"Exit\":{\"zh_CN\":\"退出\",\"zh_TW\":\"離開\",\"da\":\"Afslut\",\"en_CA\":\"Exit\",\"en_GB\":\"Exit\",\"en_US\":\"Exit\",\"et\":\"Välju\",\"fr\":\"Quitter\",\"fr_CA\":\"Quitter\",\"de\":\"Beenden\",\"hu\":\"Kilépés\",\"it\":\"Esci\",\"ja\":\"終了\",\"ko\":\"끝내기\",\"no\":\"Avslutt\",\"pl\":\"Wyjście\",\"pt\":\"Sair\",\"ru\":\"Выход\",\"es\":\"Salir\",\"es_AR\":\"Salir\",\"es_419\":\"Salir\",\"es_US\":\"Salir\",\"uk\":\"Вийти\",\"sl\":\"Zapri\",\"id\":\"Keluar\"},\"Twitter Status\":{\"zh_CN\":\"Twitter 状态\",\"zh_TW\":\"Twitter 狀態\",\"da\":\"Twitter Status\",\"en_CA\":\"Twitter Status\",\"en_GB\":\"Twitter Status\",\"en_US\":\"Twitter Status\",\"et\":\"Twitteri olek\",\"fr\":\"Statut Twitter\",\"fr_CA\":\"Statut Twitter\",\"de\":\"Twitter-Status\",\"hu\":\"Twitter állapota\",\"it\":\"Stato di Twitter\",\"ja\":\"Twitterのステータス\",\"ko\":\"트위터 상태\",\"no\":\"Twitter Status\",\"pl\":\"Status Twittera\",\"pt\":\"Estado do Twitter\",\"ru\":\"Состояние Твиттера\",\"es\":\"Estado de Twitter\",\"es_AR\":\"Estado de Twitter\",\"es_419\":\"Estado de Twitter\",\"es_US\":\"Estado de Twitter\",\"uk\":\"Стан Твіттеру\",\"sl\":\"Twitter Status\",\"id\":\"Status Twitter\"},\"Check for updates...\":{\"zh_CN\":\"检查更新...\",\"zh_TW\":\"檢查更新...\",\"da\":\"Tjek for opdateringer...\",\"en_CA\":\"Check for updates...\",\"en_GB\":\"Check for updates...\",\"en_US\":\"Check for updates...\",\"et\":\"Otsi värskendusi...\",\"fr\":\"Recherche de mises à jour...\",\"fr_CA\":\"Recherche de mises à jour...\",\"de\":\"Nach Updates suchen...\",\"hu\":\"Frissítés keresése...\",\"it\":\"Controlla gli Aggiornamenti...\",\"ja\":\"アップデートを確認\",\"ko\":\"업데이트 확인...\",\"no\":\"Se etter oppdateringer...\",\"pl\":\"Sprawdź aktualizacje...\",\"ru\":\"Проверить обновления...\",\"es\":\"Buscar actualizaciones...\",\"es_AR\":\"Buscar actualizaciones...\",\"es_419\":\"Buscar actualizaciones...\",\"es_US\":\"Buscar actualizaciones...\",\"uk\":\"Перевірити оновлення...\",\"sl\":\"Preveri za posodobitve...\",\"id\":\"Periksa pembaruan...\"}}","import { store } from \"./store\";\r\n\r\nimport { default as I18nData } from \"./i18nMain\";\r\nimport { SettingsKey } from \"../Settings/SettingsKey\";\r\nlet lang = store.get(SettingsKey.LANGUAGE);\r\n\r\nexport const I18n = function(key: string) {\r\n\t// @ts-expect-error TODO: fix this\r\n\tlet foundStr = I18nData[key];\r\n\tif (!foundStr) {\r\n\t\tconsole.warn(\"Main process missing translation: \" + key);\r\n\t\treturn key;\r\n\t}\r\n\treturn foundStr[lang] || key;\r\n}","import { HostManager } from \"./hostManager\";\r\n\r\nconst electron = require(\"electron\");\r\nconst { BrowserWindow } = electron;\r\n\r\nexport function makeLoginWindow(url: string, teams: boolean) {\r\n\r\n\tlet originalUrl = url;\r\n\r\n\tHostManager.loginWindow = new BrowserWindow({\r\n\t\twidth: 710,\r\n\t\theight: 490,\r\n\t\twebPreferences: {\r\n\t\t\tscrollBounce: true,\r\n\t\t\tnodeIntegration: false\r\n\t\t},\r\n\t\tparent:HostManager.mainWindow || null,\r\n\t\tmodal:true,\r\n\t\tautoHideMenuBar:true\r\n\t});\r\n\r\n\tHostManager.loginWindow.on(\"closed\", () => {\r\n\t\tHostManager.loginWindow = null;\r\n\t});\r\n\r\n\tHostManager.loginWindow.webContents.on(\"will-navigate\", (event: Electron.Event, url: string) => {\r\n\r\n\t\tconsole.log(\"will-navigate\", url);\r\n\t\tconst { shell } = electron;\r\n\r\n\t\tif (url.indexOf(\"https://tweetdeck.twitter.com\") >= 0 && !teams) {\r\n\t\t\tconsole.log(\"Hello tweetdeck!\");\r\n\t\t\tHostManager.loginWindow?.close?.();\r\n\t\t\tHostManager.mainWindow?.reload?.();\r\n\t\t\tevent.preventDefault();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (url.indexOf(\"twitter.com/logout\") >= 0) {\r\n\t\t\tconsole.log(\"Hello logout!\");\r\n\t\t\tHostManager.loginWindow?.close?.();\r\n\t\t\tHostManager.mainWindow?.reload?.();\r\n\t\t\tevent.preventDefault();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (url.indexOf(\"twitter.com/logout\") >= 0 || url.indexOf(\"twitter.com/login\") >= 0  || url.indexOf(\"twitter.com/i/flow/login\") >= 0 ||url.indexOf(\"twitter.com/account/login_verification\") >= 0 || teams) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (url.indexOf(\"twitter.com/account\") >= 0 || url.indexOf(\"twitter.com/signup\") >= 0|| url.indexOf(\"twitter.com/signup\") >= 0) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tshell.openExternal(url);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (url.indexOf(\"twitter.com/sessions\") >= 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tevent.preventDefault();\r\n\t});\r\n\r\n\tHostManager.loginWindow.webContents.on(\"did-navigate-in-page\", (event: Electron.Event, url: string) => {\r\n\t\tconsole.log(\"did-navigate-in-page\", url);\r\n\r\n\t\tif (url === \"https://mobile.twitter.com/\") {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tHostManager.loginWindow?.close?.();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (url.indexOf(\"https://tweetdeck.twitter.com\") >= 0) {\r\n\t\t\tconsole.log(\"Hello tweetdeck2!\");\r\n\t\t\tHostManager.mainWindow?.loadURL?.(url);\r\n\t\t\tHostManager.loginWindow?.close?.();\r\n\t\t\tevent.preventDefault();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (url.indexOf(\"/i/flow/signup\") >= 0 || url.indexOf(\"/i/flow/password_reset\") >= 0) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tHostManager.loginWindow?.webContents?.goBack?.();\r\n\t\t\tconst {shell} = electron;\r\n\t\t\tshell.openExternal(url);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (url.indexOf(\"twitter.com/logout\") >= 0 || url.indexOf(\"twitter.com/login\") >= 0 || url.indexOf(\"twitter.com/i/flow/login\") >= 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (HostManager.loginWindow) {\r\n\t\t\tHostManager.loginWindow.loadURL(originalUrl);\r\n\t\t}\r\n\t});\r\n\r\n\tHostManager.loginWindow.webContents.on(\"new-window\", (event: Electron.Event, url: string) => {\r\n\t\tconsole.log(\"new-window\", url);\r\n\t\tevent.preventDefault();\r\n\t\telectron.shell.openExternal(url);\r\n\t});\r\n\r\n\tHostManager.loginWindow.loadURL(url);\r\n\r\n\treturn HostManager.loginWindow;\r\n\r\n}\r\n","import { SettingsKey } from \"../Settings/SettingsKey\";\r\nimport { ProxyMode } from \"../Settings/Types/Proxy\";\r\nimport { HostManager } from \"./hostManager\";\r\nimport { store } from \"./store\"\r\n\r\nexport const updateProxy = () => {\r\n    const proxyMode = store.get(SettingsKey.PROXY_MODE, ProxyMode.AUTODETECT);\r\n\r\n    console.log(`Switching proxy to ${proxyMode}...`);\r\n\r\n    switch(proxyMode) {\r\n        case ProxyMode.AUTODETECT:\r\n            HostManager.mainWindow?.webContents?.session?.setProxy?.({\r\n                mode: \"auto_detect\"\r\n            });\r\n            break;\r\n        case ProxyMode.DIRECT:\r\n            HostManager.mainWindow?.webContents?.session?.setProxy?.({\r\n                mode: \"direct\"\r\n            });\r\n            break;\r\n        case ProxyMode.PAC:\r\n            HostManager.mainWindow?.webContents?.session?.setProxy?.({\r\n                mode: \"pac_script\",\r\n                pacScript: store.get(SettingsKey.PROXY_PAC_SCRIPT)\r\n            });\r\n            break;\r\n        case ProxyMode.MANUAL:\r\n            const servers = `${store.get(SettingsKey.PROXY_SERVERS, \"\").split(\"\\n\").join(\",\").split(\" \").join(\",\").split(\";\").join(\",\")},direct://`.replace(/ /g, \"\");\r\n            console.log(`Interpreted proxy servers as ${servers}`);\r\n            HostManager.mainWindow?.webContents?.session?.setProxy?.({\r\n                mode: \"fixed_servers\",\r\n                proxyRules: servers\r\n            });\r\n            break;\r\n    }\r\n    \r\n}","import { I18n } from \"./i18n\";\r\nimport { HostManager } from \"./hostManager\";\r\nimport { separator } from \"./utils\";\r\nimport { autoUpdater, desktopConfig } from \"./main\";\r\n\r\nconst { Tray, Menu, nativeImage, app } = require(\"electron\");\r\n\r\nexport function makeTray() {\r\n\tif (HostManager.tray !== null) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tlet pathName = `common${separator}assets${separator}` +\r\n\t\t\t\t\t`img${separator}app${separator}${(process.platform === \"darwin\" ? \"macOSTrayTemplate.png\" : \"Tray.png\")}`;\r\n\r\n\tconst image = nativeImage.createFromPath(pathName);\r\n\timage.setTemplateImage(true);\r\n\tHostManager.tray = new Tray(pathName);\r\n\r\n\tconst contextMenu = Menu.buildFromTemplate([\r\n\t\t{ label: I18n(\"Open ModernDeck\"), click(){ showHiddenWindow() } },\r\n\t\t{ label: (process.platform === \"darwin\" ? I18n(\"Preferences...\") : I18n(\"Settings...\")), click(){ if (!HostManager.mainWindow){return;}HostManager.mainWindow.show();HostManager.mainWindow?.webContents?.send(\"openSettings\"); } },\r\n\t\t{ visible: (typeof process.windowsStore === \"undefined\" && desktopConfig.autoUpdatePolicy !== \"disabled\"), label: (process.platform === \"darwin\" ? I18n(\"Check for Updates...\") : I18n(\"Check for updates...\")), click(){ if (!HostManager.mainWindow){return;}HostManager.mainWindow.show();HostManager.mainWindow?.webContents?.send(\"checkForUpdatesMenu\"); } },\r\n\r\n\t\t{ type: \"separator\" },\r\n\r\n\t\t{ label: I18n(\"New Tweet...\"), click(){ if (!HostManager.mainWindow){return;}HostManager.mainWindow.show();HostManager.mainWindow?.webContents?.send(\"newTweet\"); } },\r\n\t\t{ label: I18n(\"New Direct Message...\"), click(){ if (!HostManager.mainWindow){return;}HostManager.mainWindow.show();HostManager.mainWindow?.webContents?.send(\"newDM\"); } },\r\n\r\n\t\t{ type: \"separator\" },\r\n\r\n\t\t{ label: (process.platform === \"darwin\" ? I18n(\"Quit\") : I18n(\"Exit\")), click(){\r\n\t\t\tif (!HostManager.mainWindow) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tHostManager.closeForReal = true;\r\n\t\t\tautoUpdater.quitAndInstall(true,true);\r\n\t\t\t\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\t/* if auto updater is dumb and does not quit then do it anyway\r\n\t\t\t\t i think electron-updater changed their behavior because previously quitAndInstall always worked */\r\n\t\t\t\tapp.quit();\r\n\t\t\t},200)\r\n\t\t}},\r\n\t]);\r\n\r\n\tHostManager.tray.setToolTip(\"ModernDeck\");\r\n\tHostManager.tray.setContextMenu(contextMenu);\r\n\tHostManager.tray.on(\"click\", showHiddenWindow);\r\n}\r\n\r\nexport function destroyTray() {\r\n\tHostManager.tray?.destroy?.();\r\n\tHostManager.tray = null;\r\n}\r\n\r\nfunction showHiddenWindow() {\r\n\tif (!HostManager.mainWindow){\r\n\t\treturn;\r\n\t}\r\n\r\n\tHostManager.mainWindow.show();\r\n\tHostManager.mainWindowHidden = false;\r\n\r\n\tif (!HostManager.enableTray) {\r\n\t\tdestroyTray();\r\n\t}\r\n}\r\n","import { SettingsKey } from \"../Settings/SettingsKey\";\r\nimport { ProxyMode } from \"../Settings/Types/Proxy\";\r\nimport { updateAppTag } from \"./appTag\";\r\nimport { makeErrorWindow } from \"./errorWindow\";\r\nimport { startExternalLoginServer } from \"./externalLoginListener\";\r\nimport { HostManager } from \"./hostManager\";\r\nimport { I18n } from \"./i18n\";\r\nimport { makeLoginWindow } from \"./loginWindow\";\r\nimport { autoUpdater, desktopConfig, mtdSchemeHandler } from \"./main\";\r\nimport { updateProxy } from \"./proxy\";\r\nimport { store } from \"./store\";\r\nimport { destroyTray, makeTray } from \"./tray\";\r\nimport { saveImageAs } from \"./utils\";\r\nconst electron = require(\"electron\");\r\nconst { app, BrowserWindow, protocol, ipcMain, dialog, Menu, session } = electron;\r\n\r\nconst remote = require('@electron/remote/main');\r\nconst fs = require(\"fs\");\r\n\r\nfunction exitFully() {\r\n\tHostManager.closeForReal = true;\r\n\tapp.relaunch();\r\n\tapp.exit();\r\n}\r\n\r\nfunction saveWindowBounds() {\r\n\tif (!HostManager.mainWindow) {\r\n\t\treturn;\r\n\t}\r\n\ttry {\r\n\t\tlet bounds = HostManager.mainWindow.getBounds();\r\n\r\n\t\tstore.set(SettingsKey.FULL_SCREEN, HostManager.mainWindow.isFullScreen());\r\n\t\tstore.set(SettingsKey.MAXIMIZED, HostManager.mainWindow.isMaximized());\r\n\t\tif (!HostManager.mainWindow.isMaximized() && !HostManager.mainWindow.isFullScreen())\r\n\t\t\tstore.set(SettingsKey.WINDOW_BOUNDS, HostManager.mainWindow.getBounds());\r\n\r\n\t\tconst matchedDisplay = electron.screen.getDisplayMatching({\r\n\t\t\tx: bounds.x,\r\n\t\t\ty: bounds.y,\r\n\t\t\twidth: bounds.width,\r\n\t\t\theight: bounds.height\r\n\t\t});\r\n\r\n\t\tstore.set(SettingsKey.LAST_DISPLAY, matchedDisplay.id);\r\n\t} catch(e) {\r\n\t\tconsole.error(e);\r\n\t}\r\n}\r\n\r\nenum TitleBarStyle {\r\n\tDEFAULT = \"default\",\r\n\tHIDDEN = \"hidden\",\r\n}\r\n\r\ninterface WindowBounds {\r\n\tx: number;\r\n\ty: number;\r\n\twidth: number;\r\n\theight: number;\r\n}\r\n\r\n\r\nexport const makeWindow = (): void => {\r\n\tconst lock = app.requestSingleInstanceLock();\r\n\r\n\tif (!lock) {\r\n\t\tHostManager.closeForReal = true;\r\n\t\tapp.quit();\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (!store.has(SettingsKey.NATIVE_TITLE_BAR)) {\r\n\t\tstore.set(SettingsKey.NATIVE_TITLE_BAR,false);\r\n\t}\r\n\r\n\tprotocol.registerFileProtocol(\"moderndeck\", mtdSchemeHandler);\r\n\r\n\tHostManager.isRestarting = false;\r\n\r\n\tlet useFrame: boolean = (store.get(SettingsKey.NATIVE_TITLE_BAR) || store.get(SettingsKey.SAFE_MODE) || process.platform === \"darwin\") as boolean;\r\n\tlet titleBarStyle: TitleBarStyle = TitleBarStyle.HIDDEN;\r\n\r\n\tif (store.get(SettingsKey.NATIVE_TITLE_BAR)) {\r\n\t\ttitleBarStyle = TitleBarStyle.DEFAULT;\r\n\t}\r\n\r\n\tif (store.has(SettingsKey.UPDATE_CHANNEL)) {\r\n\t\tif (store.get(SettingsKey.UPDATE_CHANNEL) === \"beta\") {\r\n\t\t\tautoUpdater.allowPrerelease = true;\r\n\t\t}\r\n\t\tautoUpdater.channel = store.get(SettingsKey.UPDATE_CHANNEL);\r\n\t}\r\n\r\n\tlet bounds = (store.get(SettingsKey.WINDOW_BOUNDS) || {}) as WindowBounds;\r\n\tlet useXY = !!bounds.x && !!bounds.y\r\n\r\n\tHostManager.mainWindow = new BrowserWindow({\r\n\t\twidth: bounds.width || 1024,\r\n\t\theight: bounds.height || 660,\r\n\t\tx: useXY ? bounds.x : undefined,\r\n\t\ty: useXY ? bounds.y : undefined,\r\n\t\twebPreferences: {\r\n\t\t\tdefaultFontFamily: {\r\n\t\t\t\tstandard: \"Roboto\",\r\n\t\t\t\tserif: \"Roboto\",\r\n\t\t\t\tsansSerif: \"Roboto\",\r\n\t\t\t\tmonospace: \"RobotoMono\"\r\n\t\t\t},\r\n\t\t\tbackgroundThrottling:true,\r\n\t\t\tnodeIntegration: true,\r\n\t\t\tcontextIsolation: false,\r\n\t\t\tnodeIntegrationInSubFrames: false,\r\n\t\t\twebgl: false,\r\n\t\t\tplugins: false,\r\n\t\t\tscrollBounce: true,\r\n\t\t\t// preload: __dirname+separator+useDir+separator+\"assets\"+separator+\"js\"+separator+\"moderndeck.js\"\r\n\t\t},\r\n\t\tautoHideMenuBar: true,\r\n\t\ttitle: \"ModernDeck\",\r\n\t\t// icon:__dirname+useDir+\"/assets/favicon.ico\",\r\n\t\tframe: useFrame,\r\n\t\ttitleBarStyle: titleBarStyle,\r\n\t\tminWidth: 350,\r\n\t\tshow: false,\r\n\t\tbackgroundColor: \"#111\"\r\n\t});\r\n\r\n\t// macOS specific: Don't run from DMG, move to Applications folder.\r\n\tif (process.platform === \"darwin\" && !app.isInApplicationsFolder()) {\r\n\t\tconst { dialog } = electron;\r\n\t\tdialog.showMessageBox({\r\n\t\t\ttype: \"warning\",\r\n\t\t\ttitle: \"ModernDeck\",\r\n\t\t\tmessage: I18n(\"Updates might not work correctly if you aren't running ModernDeck from the Applications folder.\\n\\nWould you like to move it there?\"),\r\n\t\t\tbuttons: [I18n(\"Not Now\"), I18n(\"Yes, Move It\")]\r\n\t\t}).then((event: Electron.MessageBoxReturnValue) => {\r\n\t\t\tif (event.response == 1) {\r\n\t\t\t\tlet moveMe;\r\n\t\t\t\ttry {\r\n\t\t\t\t\tmoveMe = app.moveToApplicationsFolder();\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tconsole.error(e);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!moveMe){\r\n\t\t\t\t\tdialog.showMessageBox({\r\n\t\t\t\t\t\ttype: \"error\",\r\n\t\t\t\t\t\ttitle: \"ModernDeck\",\r\n\t\t\t\t\t\tmessage: I18n(\"We couldn't automatically move ModernDeck to the applications folder. You may need to move it yourself.\"),\r\n\t\t\t\t\t\tbuttons: [I18n(\"OK\")]\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t// Prevent changing the Page Title\r\n\tHostManager.mainWindow.on(\"page-title-updated\", (event: Event) => {\r\n\t\tevent.preventDefault();\r\n\t});\r\n\r\n\t// Save window bounds if it's closed, or otherwise occasionally\r\n\tHostManager.mainWindow.on(\"close\", (_event: Event) => {\r\n\t\tsetTimeout(saveWindowBounds, 0);\r\n\t});\r\n\r\n\tsetInterval(saveWindowBounds, 60 * 1000);\r\n\r\n\tHostManager.mainWindow.show();\r\n\r\n\tHostManager.mainWindowHidden = false;\r\n\r\n\t// Initialize @electron/remote and limit its scope to only electron.Menu\r\n\t// ModernDeck doesn't need @electron/remote for anything else\r\n\r\n\tremote.initialize();\r\n\tremote.enable(HostManager.mainWindow.webContents);\r\n\r\n\t// @electron/remote doesn't seem to have typing. So we use \"as any\" for them.\r\n\r\n\tapp.on(\"remote-require\" as any, (event: Event, _moduleName: string) => {\r\n\t\tevent.preventDefault();\r\n\t});\r\n\r\n\tapp.on(\"remote-get-global\" as any, (event: Event, _moduleName: string) => {\r\n\t\tevent.preventDefault();\r\n\t});\r\n\r\n\tapp.on(\"remote-get-builtin\" as any, (_: any, event: Event, moduleName: string) => {\r\n\t\tif (moduleName !== \"Menu\") {\r\n\t\t\tevent.preventDefault();\r\n\t\t}\r\n\t});\r\n\r\n\tapp.on(\"remote-get-current-window\" as any, (event: Event, _moduleName: string) => {\r\n\t\tevent.preventDefault();\r\n\t});\r\n\r\n\tapp.on(\"remote-get-current-web-contents\" as any, (event: Event, _moduleName: string) => {\r\n\t\tevent.preventDefault();\r\n\t});\r\n\t\r\n\t\r\n\tupdateAppTag();\r\n\r\n\ttry {\r\n\t\tHostManager.mainWindow?.webContents?.executeJavaScript(`\r\n\t\t\tif (document.querySelector(\"html\").classList.contains(\"scroll-v\") === false) {\r\n\t\t\t\t// TweetDeck Preview is loading, so we need to revert it to legacy\r\n\t\t\t\tdocument.cookie = \"tweetdeck_version=; domain=.twitter.com; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT\";\r\n\t\t\t\tdocument.cookie = \"tweetdeck_version=; domain=tweetdeck.twitter.com; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT\"\r\n\t\t\t\tdocument.cookie = \"tweetdeck_version=legacy; domain=.twitter.com; path=/; expires=Thu, 01 Jan 2099 00:00:00 GMT\";\r\n\t\t\t\tdocument.cookie = \"tweetdeck_version=legacy; domain=tweetdeck.twitter.com; path=/; expires=Thu, 01 Jan 2099 00:00:00 GMT\";\r\n\t\t\t\tlocation.reload();\r\n\t\t\t}\r\n\r\n\t\t\tdocument.getElementsByClassName(\"js-signin-ui block\")[0].innerHTML =\r\n\t\t\t\\`<img class=\"mtd-loading-logo\" src=\"moderndeck://assets/img/moderndeck.svg\" style=\"display: none;\">\r\n\t\t\t<div class=\"preloader-wrapper active\">\r\n\t\t\t\t<div class=\"spinner-layer\">\r\n\t\t\t\t\t<div class=\"circle-clipper left\">\r\n\t\t\t\t\t\t<div class=\"circle\"></div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"gap-patch\">\r\n\t\t\t\t\t\t<div class=\"circle\"></div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"circle-clipper right\">\r\n\t\t\t\t\t\t<div class=\"circle\"></div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\\`;\r\n\r\n\t\t\tif (typeof mtdLoadStyleCSS === \"undefined\") {\r\n\t\t\t\tmtdLoadStyleCSS = \\`\r\n\t\t\t\t\timg.spinner-centered {\r\n\t\t\t\t\t\tdisplay:none!important\r\n\t\t\t\t\t}\r\n\t\t\t\t\\`\r\n\t\t\t\tmtdLoadStyle = document.createElement(\"style\");\r\n\t\t\t\tmtdLoadStyle.appendChild(document.createTextNode(mtdLoadStyleCSS))\r\n\t\t\t\tdocument.head.appendChild(mtdLoadStyle);\r\n\t\t\t}\r\n\r\n\t\t\tif (document.getElementsByClassName(\"spinner-centered\")[0]) {\r\n\t\t\t\tdocument.getElementsByClassName(\"spinner-centered\")[0].remove();\r\n\t\t\t}\r\n\r\n\t\t\tdocument.getElementsByTagName(\"html\")[0].style = \"background: #111;\";\r\n\t\t\tdocument.getElementsByTagName(\"body\")[0].style = \"background: #111;\";\r\n\t\t`)\r\n\t} catch(e) {\r\n\r\n\t}\r\n\r\n\r\n\tHostManager.mainWindow?.webContents?.on(\"dom-ready\", () => {\r\n\r\n\t\tHostManager.mainWindow?.webContents?.executeJavaScript(`\r\n\t\t\tdocument.getElementsByTagName(\"html\")[0].style = \"background: #111!important;\";\r\n\t\t\tdocument.getElementsByTagName(\"body\")[0].style = \"background: #111!important;\";\r\n\r\n\t\t\tif (typeof mtdLoadStyleCSS === \"undefined\") {\r\n\t\t\t\tmtdLoadStyleCSS = \\`\r\n\t\t\t\t\timg.spinner-centered {\r\n\t\t\t\t\t\tdisplay:none!important\r\n\t\t\t\t\t}\r\n\t\t\t\t\\`\r\n\t\t\t\tmtdLoadStyle = document.createElement(\"style\");\r\n\t\t\t\tmtdLoadStyle.appendChild(document.createTextNode(mtdLoadStyleCSS))\r\n\t\t\t\tdocument.head.appendChild(mtdLoadStyle);\r\n\t\t\t}\r\n\r\n\t\t\tif (document.getElementsByClassName(\"spinner-centered\")[0]) {\r\n\t\t\t\tdocument.getElementsByClassName(\"spinner-centered\")[0].remove();\r\n\t\t\t}\r\n\r\n\t\t\tdocument.getElementsByClassName(\"js-signin-ui block\")[0].innerHTML =\r\n\t\t\t\\`<img class=\"mtd-loading-logo\" src=\"moderndeck://assets/img/moderndeck.svg\" style=\"display: none;\">\r\n\t\t\t<div class=\"preloader-wrapper active\">\r\n\t\t\t\t<div class=\"spinner-layer\">\r\n\t\t\t\t\t<div class=\"circle-clipper left\">\r\n\t\t\t\t\t\t<div class=\"circle\"></div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"gap-patch\">\r\n\t\t\t\t\t\t<div class=\"circle\"></div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"circle-clipper right\">\r\n\t\t\t\t\t\t<div class=\"circle\"></div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\\`;\r\n\t\t`)\r\n\r\n\t\tHostManager.mainWindow?.webContents?.executeJavaScript(\r\n\t\t\t`\r\n\t\t\tconst baseUrl = document.createElement(\"meta\");\r\n\t\t\tbaseUrl.setAttribute(\"name\", \"moderndeck-base-url\");\r\n\t\t\tbaseUrl.setAttribute(\"content\", \"moderndeck://\");\r\n\t\t\tdocument.head.appendChild(baseUrl);\r\n\t\t\t\r\n\t\t\tconst InjectScript2 = document.createElement(\"script\");\r\n\t\t\tInjectScript2.src = \"moderndeck://assets/libraries/moduleraid.min.js\";\r\n\t\t\tInjectScript2.type = \"text/javascript\";\r\n\t\t\tdocument.head.appendChild(InjectScript2);`\r\n\t\t\t+\r\n\t\t\t(store.get(SettingsKey.SAFE_MODE) ? `document.getElementsByTagName(\"html\")[0].classList.add(\"mtd-disable-css\");` :\r\n\t\t\t`const injStyles = document.createElement(\"link\");\r\n\t\t\tinjStyles.rel = \"stylesheet\";\r\n\t\t\tinjStyles.href = \"moderndeck://assets/css/moderndeck.css\";\r\n\t\t\tdocument.head.appendChild(injStyles);`)\r\n\t\t\t+\r\n\t\t\t`const InjectScript = document.createElement(\"script\");\r\n\t\t\tInjectScript.src = \"moderndeck://assets/js/moderndeck.js\";\r\n\t\t\tInjectScript.type = \"text/javascript\";\r\n\t\t\tdocument.head.appendChild(InjectScript);\r\n\t\t`);\r\n\r\n\t\tupdateAppTag();\r\n\r\n\t});\r\n\r\n\tHostManager.mainWindow?.webContents?.on(\"did-fail-load\", (_event: Event, code: number, desc: string) => {\r\n\t\t// These codes aren't necessarily fatal errors, so we ignore them instead of forcing the user to shut down ModernDeck.\r\n\r\n\t\tif (code === -3 || code === -11 || code === -2 || code === -1) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tmakeErrorWindow();\r\n\r\n\t\tHostManager.mainWindow.hide();\r\n\r\n\t\tHostManager.errorWindow.webContents.executeJavaScript(`\r\n\t\t\tdocument.getElementById(\"code\").innerHTML = \"${desc}\";\r\n\t\t\tdocument.getElementById(\"close\").innerHTML = \"${I18n(\"Close\")}\";\r\n\t\t\tdocument.getElementById(\"retry\").innerHTML = \"${I18n(\"Retry\")}\";\r\n\t\t\tdocument.getElementById(\"twitterStatus\").innerHTML = \"${I18n(\"Twitter Status\")}\";\r\n\t\t\tdocument.getElementById(\"resetProxy\").innerHTML = \"${I18n(\"Reset Proxy\")}\";\r\n\t\t`);\r\n\r\n\t\tif (store.get(SettingsKey.PROXY_MODE) === ProxyMode.AUTODETECT) {\r\n\t\t\tHostManager.errorWindow.webContents.executeJavaScript(`\r\n\t\t\t\tdocument.getElementById(\"resetProxy\").remove();\r\n\t\t\t`);\r\n\t\t}\r\n\r\n\t\tHostManager.errorWindow.show();\r\n\r\n\t\tconsole.log(code, desc);\r\n\r\n\t\treturn;\r\n\t});\r\n\r\n\t/*\r\n\t\tThe content security policy needs to be replaced to be able to interact with GIF services\r\n\t*/\r\n\r\n\tHostManager.mainWindow?.webContents?.session.webRequest.onHeadersReceived(\r\n\t\t{urls:[\"https://tweetdeck.twitter.com/*\"]},\r\n\t\t(details: Electron.OnHeadersReceivedListenerDetails, callback: any) => {\r\n\t\t\tlet foo = details.responseHeaders;\r\n\t\t\tfoo[\"content-security-policy\"] =[\r\n\t\t\t\t\"default-src 'self'; connect-src * moderndeck:; \"+\r\n\t\t\t\t\"font-src https: blob: data: * moderndeck:; \"+\r\n\t\t\t\t\"frame-src https: moderndeck:; \"+\r\n\t\t\t\t\"frame-ancestors 'self' https: moderndeck:; \"+\r\n\t\t\t\t\"img-src https: file: data: blob: moderndeck:; \"+\r\n\t\t\t\t\"media-src * moderndeck: blob: https:; \"+\r\n\t\t\t\t\"object-src 'self' https:; script-src 'self' 'unsafe-eval' https://moderndeck.app moderndeck: https://*.twitter.com https://*.twimg.com https://api-ssl.bitly.com blob:; \"+\r\n\t\t\t\t\"style-src 'self' 'unsafe-inline' 'unsafe-eval' https: moderndeck: blob:;\"];\r\n\t\t\tcallback({ responseHeaders: foo});\r\n\t\t}\r\n\t);\r\n\r\n\r\n\tHostManager.mainWindow?.webContents?.session?.webRequest?.onBeforeSendHeaders?.({urls:[\"https://twitter.com/i/jot*\", \"https://tweetdeck.twitter.com/Users*\"]}, (_details: Electron.OnBeforeSendHeadersListenerDetails, callback: (beforeSendResponse: Electron.BeforeSendResponse) => void) => {\r\n\t\tcallback({cancel: true})\r\n\t})\r\n\r\n\t// HostManager.mainWindow?.webContents?.session.webRequest.onHeadersReceived(\r\n\t// \t{urls:[\"https://*.twitter.com/*\",\"https://*.twimg.com/*\"]},\r\n\t// \t(details, callback) => {\r\n\t// \t\tlet foo = details.responseHeaders;\r\n\t// \t\tfoo[\"Access-Control-Allow-Origin\"] =[\r\n\t// \t\t\t\"moderndeck://.\"];\r\n\t// \t\tfoo[\"Access-Control-Allow-Credentials\"] = [\r\n\t// \t\t\t\"true\"\r\n\t// \t\t]\r\n\t// \t\tcallback({ responseHeaders: foo});\r\n\t// \t}\r\n\t// );\r\n\r\n\t// Update the proxy before attempting to load the page\r\n\tupdateProxy();\r\n\r\n\ttry {\r\n\t\tHostManager.mainWindow.webContents.loadURL(\"https://tweetdeck.twitter.com\");\r\n\t} catch(e) {\r\n\t\tconsole.error(e)\r\n\t}\r\n\r\n\tupdateProxy();\r\n\r\n\t/*\r\n\r\n\t\tWeb content requests to navigate away from page.\r\n\r\n\t\tIf this is not a TweetDeck URL, we will instead pass\r\n\t\tit on to the browser, unless...\r\n\r\n\t\t...if it is a Twitter URL, we pop it up in a login Window.\r\n\r\n\t*/\r\n\r\n\tHostManager.mainWindow?.webContents?.on?.(\"will-navigate\", (event: Electron.Event, url: string) => {\r\n\r\n\t\tconst { shell } = electron;\r\n\t\tconsole.log(url);\r\n\r\n\t\tif (url.indexOf(\"https://tweetdeck.twitter.com\") < 0 && url.indexOf(\"moderndeck://.\") < 0) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tif (url.indexOf(\"twitter.com/login\") >= 0 || url.indexOf(\"twitter.com/i/flow/login\") >= 0 || url.indexOf(\"twitter.com/logout\") >= 0) {\r\n\t\t\t\tconsole.log(\"this is a login window! will-navigate\");\r\n\t\t\t\tmakeLoginWindow(url, false);\r\n\t\t\t} else {\r\n\t\t\t\tshell.openExternal(url);\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\r\n\t\tupdateAppTag();\r\n\t});\r\n\r\n\t/*\r\n\r\n\t\tWeb content requests to open a new window.\r\n\r\n\t\tThis is redirected in browser if it is not a TweetDeck URL.\r\n\r\n\t\tIf it is a Twitter URL, we pop it up in a login Window.\r\n\r\n\t*/\r\n\r\n\tHostManager.mainWindow?.webContents?.on?.(\"new-window\", (event: Electron.NewWindowWebContentsEvent, url: string) => {\r\n\t\tconst { shell } = electron;\r\n\t\tevent.preventDefault();\r\n\t\tconsole.log(url);\r\n\r\n\t\tif (url.indexOf(\"https://twitter.com/teams/authorize\") >= 0) {\r\n\t\t\tconsole.log(\"this is a login teams window! new-window\");\r\n\t\t\tevent.newGuest = makeLoginWindow(url,true);\r\n\t\t} else if (url.indexOf(\"twitter.com/login\") >= 0 || url.indexOf(\"twitter.com/i/flow/login\") >= 0 || url.indexOf(\"twitter.com/logout\") >= 0) {\r\n\t\t\tconsole.log(\"this is a login non-teams window! new-window\");\r\n\t\t\tevent.newGuest = makeLoginWindow(url,false);\r\n\t\t} else {\r\n\t\t\tshell.openExternal(url).catch(() => {\r\n\t\t\t\tHostManager.mainWindow?.webContents?.send(\"failedOpenUrl\");\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\treturn event.newGuest;\r\n\r\n\t});\r\n\r\n\t// i actually forget why this is here\r\n\r\n\tHostManager.mainWindow?.webContents?.on?.(\"context-menu\", (_event: Electron.Event, params: Electron.ContextMenuParams) => {\r\n\t\tHostManager.mainWindow?.webContents?.send(\"context-menu\", params);\r\n\t});\r\n\r\n\tipcMain.on(\"getDesktopConfig\", () => {\r\n\t\tHostManager.mainWindow?.webContents?.send(\"desktopConfig\", desktopConfig);\r\n\t});\r\n\r\n\tipcMain.on(\"focus\", () => {\r\n\t\tconsole.log(\"Focus!\");\r\n\t\tHostManager.mainWindow?.focus?.();\r\n\t});\r\n\r\n\tipcMain.on(\"changeProxy\", () => {\r\n\t\tupdateProxy();\r\n\t});\r\n\r\n\t/*\r\n\t\tIf a user uses native context menus, this is browser telling us\r\n\t\tto put up a native context menu with the given commands, instead\r\n\t\tof it doing it itself.\r\n\t*/\r\n\r\n\tipcMain.on(\"nativeContextMenu\", (_event: Electron.IpcMainEvent, params: any) => {\r\n\t\tconsole.log(params);\r\n\t\tlet newMenu = Menu.buildFromTemplate(params);\r\n\t\tconsole.log(newMenu);\r\n\t\tnewMenu.popup();\r\n\t});\r\n\r\n\tipcMain.on(\"errorReload\", () => {\r\n\t\tHostManager.shouldQuitIfErrorClosed = false;\r\n\t\tHostManager.mainWindow.reload();\r\n\t\tHostManager.mainWindow.show();\r\n\t\tHostManager.errorWindow.close();\r\n\t});\r\n\r\n\tipcMain.on(\"resetProxy\", () => {\r\n\t\tstore.set(SettingsKey.PROXY_MODE, ProxyMode.AUTODETECT);\r\n\t\tupdateProxy();\r\n\t});\r\n\r\n\tipcMain.on(\"loadSettingsDialog\", () => {\r\n\t\tdialog.showOpenDialog(\r\n\t\t\t{ filters: [{ name: I18n(\"Preferences JSON File\"), extensions: [\"json\"] }] }\r\n\t\t).then((results) => {\r\n\t\t\tconsole.log(results);\r\n\t\t\tif (typeof results.filePaths === \"undefined\") {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tfs.readFile(results.filePaths[0], \"utf-8\", (_: any, load: string) => {\r\n\t\t\t\tHostManager.mainWindow?.webContents?.send(\"settingsReceived\", JSON.parse(load));\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\r\n\tipcMain.on(\"tweetenImportDialog\", () => {\r\n\t\tdialog.showOpenDialog(\r\n\t\t\t{ filters: [{ name: I18n(\"Tweeten Settings JSON\"), extensions: [\"json\"] }] }\r\n\t\t).then((results) => {\r\n\t\t\tif (typeof results.filePaths === \"undefined\") {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tfs.readFile(results.filePaths[0], \"utf-8\", (_: any, load: string) => {\r\n\t\t\t\tHostManager.mainWindow?.webContents?.send(\"tweetenSettingsReceived\", JSON.parse(load));\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n\r\n\tipcMain.on(\"saveSettings\", (_event: Electron.IpcMainEvent, params: any) => {\r\n\t\tdialog.showSaveDialog(\r\n\t\t\t{\r\n\t\t\t\ttitle: I18n(\"ModernDeck Preferences\"),\r\n\t\t\t\tdefaultPath: \"settings.json\",\r\n\t\t\t\tfilters: [{ name: I18n(\"Preferences JSON File\"), extensions: [\"json\"] }]\r\n\t\t\t}\r\n\t\t).then((results) => {\r\n\t\t\tif (results.filePath === undefined) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tfs.writeFile(results.filePath, params, (_: any) => {});\r\n\t\t});\r\n\t})\r\n\r\n\tipcMain.on(\"errorQuit\", () => {\r\n\t\tapp.quit();\r\n\t});\r\n\r\n\tipcMain.on(\"drawerOpen\", () => {\r\n\t\tconsole.log(\"open\");\r\n\r\n\t\tHostManager.mainWindow?.webContents?.executeJavaScript(\"document.querySelector(\\\"html\\\").classList.add(\\\"mtd-drawer-open\\\");\");\r\n\t});\r\n\r\n\tipcMain.on(\"drawerClose\", () => {\r\n\t\tconsole.log(\"close\");\r\n\r\n\t\tHostManager.mainWindow?.webContents?.executeJavaScript(\"document.querySelector(\\\"html\\\").classList.remove(\\\"mtd-drawer-open\\\");\");\r\n\t});\r\n\r\n\r\n\tipcMain.on(\"maximizeButton\", () => {\r\n\t\tlet window = BrowserWindow.getFocusedWindow();\r\n\r\n\t\tif (!window) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (window.isMaximized()) {\r\n\t\t\twindow.unmaximize();\r\n\t\t} else {\r\n\t\t\twindow.maximize();\r\n\t\t}\r\n\t});\r\n\r\n\tipcMain.on(\"minimize\", () => {\r\n\t\tBrowserWindow.getFocusedWindow().minimize();\r\n\t});\r\n\r\n\t/*\r\n\t\tThe options below are for right click menu actions\r\n\t*/\r\n\r\n\tipcMain.on(\"copy\", () => {\r\n\t\tHostManager.mainWindow?.webContents?.copy?.();\r\n\t});\r\n\r\n\tipcMain.on(\"cut\", () => {\r\n\t\tHostManager.mainWindow?.webContents?.cut?.();\r\n\t});\r\n\r\n\tipcMain.on(\"paste\", () => {\r\n\t\tHostManager.mainWindow?.webContents?.paste?.();\r\n\t});\r\n\r\n\tipcMain.on(\"delete\", () => {\r\n\t\tHostManager.mainWindow?.webContents?.delete?.();\r\n\t});\r\n\r\n\tipcMain.on(\"selectAll\", () => {\r\n\t\tHostManager.mainWindow?.webContents?.selectAll?.();\r\n\t});\r\n\r\n\tipcMain.on(\"undo\", () => {\r\n\t\tHostManager.mainWindow?.webContents?.undo?.();\r\n\t});\r\n\r\n\tipcMain.on(\"redo\", () => {\r\n\t\tHostManager.mainWindow?.webContents?.redo?.();\r\n\t});\r\n\r\n\tipcMain.on(\"copyImage\", (_event: Electron.IpcMainEvent, arg: { x: number, y: number}) => {\r\n\t\tHostManager.mainWindow?.webContents?.copyImageAt?.(arg.x, arg.y);\r\n\t});\r\n\r\n\tipcMain.on(\"saveImage\", (_event: Electron.IpcMainEvent, arg: string) => {\r\n\t\tsaveImageAs(arg);\r\n\t});\r\n\r\n\tipcMain.on(\"inspectElement\", (_event: Electron.IpcMainEvent, arg: { x: number, y: number}) => {\r\n\t\tHostManager.mainWindow?.webContents?.inspectElement?.(arg.x, arg.y);\r\n\t});\r\n\r\n\tipcMain.on(\"showEmojiPanel\", () => {\r\n\t\tapp.showEmojiPanel();\r\n\t})\r\n\r\n\t// browser initiated app restart\r\n\r\n\tipcMain.on(\"restartApp\", () => {\r\n\t\tsetTimeout(exitFully, 100);\r\n\t});\r\n\r\n\t// browser initiated app restart, after user clicks to restart to install updates\r\n\r\n\tipcMain.on(\"restartAndInstallUpdates\", () => {\r\n\t\tHostManager.closeForReal = true;\r\n\t\tautoUpdater.quitAndInstall(false, true);\r\n\t});\r\n\r\n\t// When user elects to erase all of their settings, we wipe everything clean, including caches\r\n\r\n\tipcMain.on(\"destroyEverything\", async() => {\r\n\t\tlet ses = session.defaultSession;\r\n\t\tstore.clear();\r\n\t\tses.flushStorageData();\r\n\t\tawait ses.clearCache();\r\n\t\tses.clearHostResolverCache();\r\n\t\tawait ses.cookies.flushStore();\r\n\t\tses.clearStorageData({\r\n\t\t\tstorages:[\"appcache\", \"cookies\", \"filesystem\", \"indexdb\", \"localstorage\", \"shadercache\", \"websql\", \"serviceworkers\"],\r\n\t\t\tquotas: [\"temporary\", \"persistent\", \"syncable\"]\r\n\t\t})\r\n\r\n\t\tsetTimeout(exitFully, 500);\r\n\t});\r\n\r\n\t// Changing from immersive titlebar to native\r\n\r\n\tipcMain.on(\"setNativeTitlebar\", (_event: Electron.IpcMainEvent, arg: boolean) => {\r\n\t\tHostManager.isRestarting = true;\r\n\r\n\t\tif (HostManager.mainWindow) {\r\n\t\t\tHostManager.closeForReal = true;\r\n\t\t\tHostManager.mainWindow.close();\r\n\t\t}\r\n\r\n\t\tstore.set(SettingsKey.NATIVE_TITLE_BAR, arg);\r\n\r\n\t\tsetTimeout(exitFully, 100);\r\n\r\n\t});\r\n\r\n\tHostManager.mainWindow.on(\"close\", (event: Electron.Event) => {\r\n\t\tif (HostManager.enableBackground && !HostManager.closeForReal) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tHostManager.mainWindow.hide();\r\n\t\t\tHostManager.mainWindowHidden = true;\r\n\r\n\t\t\t// If tray disabled, show tray only if background is enabled\r\n\t\t\tif (!HostManager.enableTray && process.platform !== \"darwin\") {\r\n\t\t\t\tmakeTray();\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n\r\n\t// Enable tray icon\r\n\tipcMain.on(\"enableTray\", (_event: Electron.IpcMainEvent) => {\r\n\t\tHostManager.enableTray = true;\r\n\t\tmakeTray();\r\n\t});\r\n\r\n\t// Disable tray icon\r\n\tipcMain.on(\"disableTray\", (_event: Electron.IpcMainEvent) => {\r\n\t\tHostManager.enableTray = false;\r\n\t\tdestroyTray();\r\n\t});\r\n\r\n\t// Enable background notifications\r\n\tipcMain.on(\"enableBackground\", (_event: Electron.IpcMainEvent) => {\r\n\t\tHostManager.enableBackground = true;\r\n\t});\r\n\r\n\t// Disable background notifications\r\n\tipcMain.on(\"disableBackground\", (_event: Electron.IpcMainEvent) => {\r\n\t\tHostManager.enableBackground = false;\r\n\t});\r\n\r\n\tipcMain.on(\"start-external-server\", (_event: Electron.IpcMainEvent) => {\r\n\t\tstartExternalLoginServer();\r\n\t})\r\n\r\n\tipcMain.on(\"beam-external-login-to-browser\", (_event: Electron.IpcMainEvent) => {\r\n\t\tconst { shell } = require(\"electron\");\r\n\t\tshell.openExternal(\"https://tweetdeck.twitter.com/?moderndeck_external_login=1\");\r\n\t})\r\n\r\n\t// Upon closing, set HostManager.mainWindow to null\r\n\tHostManager.mainWindow.on(\"closed\", () => {\r\n\t\tHostManager.mainWindow = null;\r\n\t});\r\n\r\n\t// Change maximise to restore size window\r\n\tHostManager.mainWindow.on(\"maximize\", () => {\r\n\t\tHostManager.mainWindow?.webContents?.executeJavaScript?.('\\\r\n\t\t\tdocument.querySelector(\"html\").classList.add(\"mtd-maximized\");\\\r\n\t\t\tdocument.querySelector(\".windowcontrol.max\").innerHTML = \"&#xE3E0\";\\\r\n\t\t');\r\n\t});\r\n\r\n\t// Change restore size window to maximize\r\n\tHostManager.mainWindow.on(\"unmaximize\", () => {\r\n\t\tHostManager.mainWindow?.webContents?.executeJavaScript?.('\\\r\n\t\t\tdocument.querySelector(\"html\").classList.remove(\"mtd-maximized\");\\\r\n\t\t\tdocument.querySelector(\".windowcontrol.max\").innerHTML = \"&#xE3C6\";\\\r\n\t\t');\r\n\t});\r\n\r\n\tif (store.get(SettingsKey.MAXIMIZED)) {\r\n\t\tHostManager.mainWindow?.maximize?.();\r\n\t}\r\n\r\n\t/*\r\n\t\tUpon entering full screen, remove app-specific CSS Classes,\r\n\t\tas there is less reason for a huge drag bar in full screen,\r\n\t\tat least in comparison to in windowed. Chrome itself does this too.\r\n\t*/\r\n\tHostManager.mainWindow.on(\"enter-full-screen\", () => {\r\n\t\tHostManager.mainWindow?.webContents?.executeJavaScript?.('document.querySelector(\"html\").classList.remove(\"mtd-app\");\\\r\n\t\t\tdocument.querySelector(\"html\").classList.remove(\"mtd-app-win\");\\\r\n\t\t\tdocument.querySelector(\"html\").classList.remove(\"mtd-app-mac\");\\\r\n\t\t\tdocument.querySelector(\"html\").classList.remove(\"mtd-app-linux\");\\\r\n\t\t');\r\n\t});\r\n\r\n\tif (store.get(SettingsKey.FULL_SCREEN)) {\r\n\t\tHostManager.mainWindow?.webContents?.executeJavaScript?.('document.querySelector(\"html\").classList.remove(\"mtd-app\");');\r\n\t\tHostManager.mainWindow?.setFullScreen?.(true)\r\n\t}\r\n\r\n\tHostManager.mainWindow.on(\"leave-full-screen\", () => {\r\n\t\tstore.set(SettingsKey.FULL_SCREEN, false);\r\n\t\tupdateAppTag();\r\n\t});\r\n\r\n\tupdateAppTag();\r\n}\r\n\r\n\r\n\r\nexport const getWebContents = () => {\r\n\tif (HostManager.mainWindow) {\r\n\t\treturn HostManager.mainWindow.webContents;\r\n\t}\r\n\treturn null;\r\n}\r\n","// import { log } from 'electron-log';\r\nconst { ipcMain } = require('electron');\r\nconst autoUpdater = require('electron-updater').autoUpdater;\r\nimport { SettingsKey } from '../Settings/SettingsKey';\r\nimport { desktopConfig} from './main';\r\nimport { getWebContents } from './mainWindow';\r\nimport { store } from './store';\r\nimport { isFlatpak } from './utils';\r\n\r\nexport const initAutoUpdater = (): typeof autoUpdater => {\r\n    autoUpdater.setFeedURL({\r\n        \"owner\": \"dangeredwolf\",\r\n        \"repo\": \"ModernDeck\",\r\n        \"provider\": \"github\"\r\n    });\r\n    // TODO: Fix autoupdater logging\r\n    // autoUpdater.logger = log;\r\n    // autoUpdater.logger.transports.file.level = \"info\";\r\n    \r\n    switch(desktopConfig.autoUpdatePolicy) {\r\n        case \"disabled\":\r\n        case \"manual\":\r\n        case \"checkOnly\":\r\n        case \"autoDownload\":\r\n            if (desktopConfig.autoUpdateInstallOnQuit === false) {\r\n                autoUpdater.autoInstallOnAppQuit = false;\r\n            }\r\n    \r\n            if (desktopConfig.autoUpdatePolicy !== \"autoDownload\") {\r\n                autoUpdater.autoDownload = false;\r\n            }\r\n    \r\n            break;\r\n    }\r\n\r\n    if (desktopConfig.autoUpdatePolicy !== \"disabled\" && desktopConfig.autoUpdatePolicy !== \"manual\" && isFlatpak !== false) {\r\n        setInterval(() => {\r\n            try {\r\n                autoUpdater.checkForUpdates();\r\n            } catch(e) {\r\n                console.error(e);\r\n            }\r\n        },1000*60*15); //check for updates once every 15 minutes\r\n    }\r\n\r\n    setTimeout(() => {\r\n        try {\r\n            if (desktopConfig.autoUpdatePolicy !== \"disabled\" &&  desktopConfig.autoUpdatePolicy !== \"manual\" && isFlatpak !== true) {\r\n                autoUpdater.checkForUpdates();\r\n            }\r\n        } catch(e) {\r\n            console.error(e);\r\n        }\r\n    }, 5000);\r\n\r\n\r\n    // Tell browser that there was an update error\r\n\r\n    autoUpdater.on(\"error\", (event: Event, blah: string, blah2: string) => {\r\n        getWebContents().send(\"error\", event, blah, blah2);\r\n    });\r\n\r\n    // Let moderndeck.js know that we are...\r\n\r\n    // ... actively checking for updates\r\n    autoUpdater.on(\"checking-for-update\", (event: Event) => {\r\n        getWebContents().send(\"checking-for-update\", event);\r\n    });\r\n\r\n    // ...currently downloading updates\r\n    autoUpdater.on(\"download-progress\", (event: Event) => {\r\n        getWebContents().send(\"download-progress\", event);\r\n    });\r\n\r\n    // ...have found an update\r\n    autoUpdater.on(\"update-available\", (event: Event) => {\r\n        getWebContents().send(\"update-available\", event);\r\n    });\r\n\r\n    // ...have already downloaded updates\r\n    autoUpdater.on(\"update-downloaded\", (event: Event) => {\r\n        getWebContents().send(\"update-downloaded\", event);\r\n    });\r\n\r\n    // ...haven't found any updates\r\n    autoUpdater.on(\"update-not-available\", (event: Event) => {\r\n        getWebContents().send(\"update-not-available\", event);\r\n    });\r\n\r\n    // moderndeck can send manual update check requests\r\n    ipcMain.on(\"checkForUpdates\", (_event: Event) => {\r\n        console.log(\"Client requested update check\");\r\n        if (autoUpdater && desktopConfig.autoUpdatePolicy !== \"disabled\" && isFlatpak !== true) {\r\n            autoUpdater.checkForUpdates();\r\n        }\r\n    });\r\n\r\n    ipcMain.on(\"downloadUpdates\", (_event: Event) => {\r\n        console.log(\"Client requested update download\");\r\n        if (autoUpdater && desktopConfig?.autoUpdatePolicy !== \"disabled\") {\r\n            autoUpdater.downloadUpdate();\r\n        }\r\n    });\r\n\r\n    // Main -> Beta and vice versa\r\n    ipcMain.on(\"changeChannel\", (_event: Event) => {\r\n        autoUpdater.allowPrerelease = store.get(SettingsKey.UPDATE_CHANNEL) === \"beta\";\r\n        autoUpdater.channel = store.get(SettingsKey.UPDATE_CHANNEL);\r\n    });\r\n\r\n\r\n    return autoUpdater;\r\n}","const { app, dialog, globalShortcut } = require(\"electron\");\r\nconst fs = require(\"fs\");\r\n\r\nexport type DesktopConfig = {\r\n    autoUpdatePolicy?: \"disabled\" | \"manual\" | \"checkOnly\" | \"autoDownload\";\r\n    autoUpdateInstallOnQuit?: boolean;\r\n    customLoginImage?: string;\r\n    disableZoom?: boolean;\r\n    disableDevTools?: boolean;\r\n}\r\n\r\nexport const tryConfig = (): DesktopConfig => {\r\n    if (process.platform === \"win32\") {\r\n        try {\r\n            let configFile = fs.readFileSync(\"C:\\\\ProgramData\\\\ModernDeck\\\\config.json\");\r\n    \r\n            try {\r\n                return JSON.parse(String(configFile)) as DesktopConfig;\r\n            } catch(e) {\r\n                app.on(\"ready\", () => {\r\n                    dialog.showMessageBoxSync({\r\n                        type:\"error\",\r\n                        title:\"ModernDeck\",\r\n                        message:\"ModernDeck detected a device config file, but an error occurred while reading it. Please ensure the JSON is free from any errors.\\n\\n\" + e\r\n                    });\r\n                })\r\n\r\n                return {} as DesktopConfig;\r\n            }\r\n        } catch (e) {\r\n            // console.error(\"Could not read device config file\");\r\n            // console.error(e);\r\n        }\r\n    }\r\n    return {} as DesktopConfig;\r\n}\r\n\r\nexport const loadDesktopConfigMain = (desktopConfig: any) => {\r\n\tif (desktopConfig.disableDevTools) {\r\n\t\t// https://stackoverflow.com/questions/40304833/how-to-make-the-dev-tools-not-show-up-on-screen-by-default-electron\r\n\t\tglobalShortcut.register(\"Control+Shift+I\", () => {});\r\n\t}if (desktopConfig.disableZoom) {\r\n\t\tglobalShortcut.register(\"Control+-\", () => {});\r\n\t\tglobalShortcut.register(\"Control+Shift+=\", () => {});\r\n\t}\r\n}","import { HostManager } from \"./hostManager\";\r\nimport { I18n } from \"./i18n\";\r\n\r\nconst electron = require(\"electron\")\r\nconst { Menu } = electron\r\n\r\nexport const setMenuBar = (): void => {\r\n\r\n    const template = [\r\n        {\r\n            label: \"ModernDeck\",\r\n            role: \"appMenu\",\r\n            submenu: [\r\n                { label: I18n(\"About ModernDeck\"), click() { if (!HostManager.mainWindow){return;}HostManager.mainWindow.show();HostManager.mainWindow?.webContents?.send(\"aboutMenu\"); } },\r\n                { label: I18n(\"Check for Updates...\"), click(){ if (!HostManager.mainWindow){return;}HostManager.mainWindow.show();HostManager.mainWindow?.webContents?.send(\"checkForUpdatesMenu\"); } },\r\n                { type: \"separator\" },\r\n                { label: I18n(\"Preferences...\"), click(){ if (!HostManager.mainWindow){return;}HostManager.mainWindow.show();HostManager.mainWindow?.webContents?.send(\"openSettings\"); } },\r\n                { label: I18n(\"Accounts...\"), click(){ if (!HostManager.mainWindow){return;}HostManager.mainWindow.show();HostManager.mainWindow?.webContents?.send(\"accountsMan\"); } },\r\n                { type: \"separator\" },\r\n                { role: \"services\" },\r\n                { type: \"separator\" },\r\n                { role: \"hide\" },\r\n                { role: \"hideothers\" },\r\n                { role: \"unhide\" },\r\n                { type: \"separator\" },\r\n                { role: \"quit\" }\r\n            ]\r\n        },\r\n        {\r\n            role: \"fileMenu\",\r\n            submenu: [\r\n                { label: I18n(\"New Tweet...\"), click(){ if (!HostManager.mainWindow){return;}HostManager.mainWindow.show();HostManager.mainWindow?.webContents?.send(\"newTweet\"); } },\r\n                { label: I18n(\"New Direct Message...\"), click(){ if (!HostManager.mainWindow){return;}HostManager.mainWindow.show();HostManager.mainWindow?.webContents?.send(\"newDM\"); } },\r\n                { type: \"separator\" },\r\n                { role: \"close\" }\r\n            ]\r\n        },\r\n        {\r\n            role: \"editMenu\",\r\n            submenu: [\r\n                { role: \"undo\" },\r\n                { role: \"redo\" },\r\n                { type: \"separator\" },\r\n                { role: \"cut\" },\r\n                { role: \"copy\" },\r\n                { role: \"paste\" },\r\n                { role: \"delete\" },\r\n                { role: \"selectAll\" },\r\n                { type: \"separator\" },\r\n                {\r\n                    label: I18n(\"Speech\"),\r\n                    submenu: [\r\n                        { role: \"startspeaking\" },\r\n                        { role: \"stopspeaking\" }\r\n                    ]\r\n                }\r\n            ]\r\n        },\r\n        {\r\n            role: \"viewMenu\",\r\n            submenu: [\r\n                { role: \"reload\" },\r\n                { role: \"forcereload\" },\r\n                { type: \"separator\" },\r\n                { role: \"resetzoom\" },\r\n                { role: \"zoomin\" },\r\n                { role: \"zoomout\" },\r\n                { role: \"toggledevtools\" },\r\n                { type: \"separator\" },\r\n                { role: \"togglefullscreen\" }\r\n            ]\r\n        },\r\n        {\r\n            role: \"windowMenu\",\r\n            submenu: [\r\n                { role: \"minimize\" },\r\n                { role: \"zoom\" },\r\n                { type: \"separator\" },\r\n                { role: \"front\" },\r\n                { type: \"separator\" },\r\n                { role: \"window\" }\r\n            ]\r\n        },\r\n        {\r\n            role: \"help\",\r\n            submenu: [\r\n                { label: I18n(\"Send Feedback\"), click(){ electron.shell.openExternal(\"https://github.com/dangeredwolf/ModernDeck/issues\");}},\r\n                { label: I18n(\"Message @ModernDeck\"), click(){ if (!HostManager.mainWindow){electron.shell.openExternal(\"https://twitter.com/messages/compose?recipient_id=2927859037\");return;}HostManager.mainWindow.show();HostManager.mainWindow?.webContents?.send(\"msgModernDeck\"); } },\r\n            ]\r\n        }\r\n    ]\r\n    \r\n    \r\n    const menu = Menu.buildFromTemplate(template as Electron.MenuItemConstructorOptions[]);\r\n    \r\n    // if (process.platform === \"darwin\")\r\n    Menu.setApplicationMenu(menu);\r\n}","/*\r\n\tmain.js\r\n\tCopyright (c) 2014-2022 dangeredwolf\r\n\tReleased under the MIT license\r\n\r\n\tmade with love <3\r\n\r\n*/\r\n\r\nconst electron = require(\"electron\");\r\n\r\nconst {\r\n\tapp,\r\n\tnativeTheme\r\n} = electron;\r\n\r\nconst path = require(\"path\");\r\nconst url = require(\"url\");\r\n\r\nimport { initAutoUpdater } from \"./autoUpdater\";\r\n\r\nimport{ tryConfig, DesktopConfig, loadDesktopConfigMain } from \"./config\";\r\nimport { HostManager } from \"./hostManager\";\r\nimport { makeTray } from \"./tray\";\r\nimport { makeWindow } from \"./mainWindow\";\r\nimport { setMenuBar } from \"./menubar\";\r\n\r\nexport let desktopConfig: DesktopConfig = tryConfig();\r\nexport let autoUpdater = initAutoUpdater();\r\n\r\napp.setAppUserModelId(\"com.dangeredwolf.ModernDeck\");\r\n\r\nlet useDir = \"common\";\r\n\r\nexport const mtdSchemeHandler = async (request: Electron.ProtocolRequest, callback: (response: string | Electron.ProtocolResponse) => void) => {\r\n\tif (request.url === \"moderndeck://background/\") {\r\n\t\tcallback({\r\n\t\t\tpath: desktopConfig.customLoginImage\r\n\t\t});\r\n\t\treturn;\r\n\t}\r\n\tlet myUrl = new url.URL(request.url);\r\n\tconst filePath = path.join(electron.app.getAppPath(), useDir, myUrl.hostname, myUrl.pathname);\r\n\r\n\tcallback({\r\n\t\tpath: filePath\r\n\t});\r\n};\r\n\r\nsetMenuBar();\r\n\r\n// Register moderndeck:// protocol for accessing moderndeck assets, like CSS, images, etc.\r\n\r\nelectron.protocol.registerSchemesAsPrivileged([{\r\n\tscheme:\"moderndeck\",\r\n\tprivileges:{\r\n\t\tbypassCSP:true,\r\n\t\tsecure:true,\r\n\t\tstandard:true,\r\n\t\tallowServiceWorkers:true,\r\n\t\tsupportFetchAPI:true,\r\n\t\tcorsEnabled:true\r\n\t}\r\n}]);\r\n\r\napp.setAsDefaultProtocolClient(\"moderndeck\");\r\n\r\n// Make window when app is ready\r\n\r\napp.on(\"ready\", () => {\r\n\ttry {\r\n\t\tmakeWindow();\r\n\t\tloadDesktopConfigMain(desktopConfig);\r\n\t\tif (HostManager.enableTray) {\r\n\t\t\tmakeTray();\r\n\t\t}\r\n\t}\r\n\tcatch (e) {\r\n\t\tconsole.error(e);\r\n\t}\r\n});\r\n\r\n// After all windows are closed, we can quit, unless restarting for update\r\n\r\napp.on(\"window-all-closed\", () => {\r\n\tif (!HostManager.isRestarting && process.platform != \"darwin\") {\r\n\t\tapp.quit();\r\n\t}\r\n});\r\n\r\napp.on(\"before-quit\", () => {\r\n\tHostManager.closeForReal = true;\r\n})\r\n\r\n// Make window if it doesn't exist, if user clicks app icon\r\n\r\napp.on(\"activate\", () => {\r\n\tif (HostManager.mainWindow === null) {\r\n\t\tmakeWindow();\r\n\t}\r\n\tif (HostManager.mainWindowHidden && HostManager.mainWindow && HostManager.mainWindow.show) {\r\n\t\tHostManager.mainWindow.show();\r\n\t\tHostManager.mainWindowHidden = false;\r\n\t}\r\n});\r\n\r\napp.on(\"second-instance\", () => {\r\n\tif (HostManager.mainWindow) {\r\n\t\tif (HostManager.mainWindow.isMinimized()) {\r\n\t\t\tHostManager.mainWindow.restore();\r\n\t\t}\r\n\t\tHostManager.mainWindow.show();\r\n\t\tHostManager.mainWindow.focus();\r\n\t}\r\n})\r\n\r\n// OS inverted color scheme (high contrast) mode changed. We automatically respond to changes for accessibility\r\n\r\nnativeTheme.on(\"updated\", (_event: Event) => {\r\n\tHostManager.mainWindow?.webContents?.send(\"inverted-color-scheme-changed\",nativeTheme.shouldUseInvertedColorScheme);\r\n});\r\n\r\nsetTimeout(() => {\r\n\tHostManager.mainWindow?.webContents?.send(\r\n\t\t\"inverted-color-scheme-changed\",\r\n\t\t!!nativeTheme.shouldUseInvertedColorScheme\r\n\t);\r\n}, 5000)"],"names":["SettingsKey","ProxyMode","ManualProxyType","__webpack_require__","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","mainWindow","errorWindow","loginWindow","tray","shouldQuitIfErrorClosed","closeForReal","mainWindowHidden","enableTray","enableBackground","isRestarting","store","require","name","separator","process","platform","isAppX","windowsStore","isFlatpak","env","FLATPAK_HOST","isMAS","mas","https","fs","dialog","app","mtdAppTag","updateAppTag","HostManager","webContents","executeJavaScript","isEmojiPanelSupported","NATIVE_TITLE_BAR","FULL_SCREEN","electron","BrowserWindow","shell","WebSocketServer","beganServer","lang","LANGUAGE","I18n","foundStr","console","warn","makeLoginWindow","url","teams","originalUrl","width","height","webPreferences","scrollBounce","nodeIntegration","parent","modal","autoHideMenuBar","on","event","log","indexOf","close","reload","preventDefault","openExternal","loadURL","goBack","updateProxy","proxyMode","PROXY_MODE","AUTODETECT","session","setProxy","mode","DIRECT","PAC","pacScript","PROXY_PAC_SCRIPT","MANUAL","servers","PROXY_SERVERS","split","join","replace","proxyRules","Tray","Menu","nativeImage","makeTray","pathName","createFromPath","setTemplateImage","contextMenu","buildFromTemplate","label","click","showHiddenWindow","send","visible","desktopConfig","autoUpdatePolicy","type","setTimeout","quit","setToolTip","setContextMenu","destroyTray","destroy","show","TitleBarStyle","protocol","ipcMain","remote","exitFully","relaunch","exit","saveWindowBounds","bounds","getBounds","set","isFullScreen","MAXIMIZED","isMaximized","WINDOW_BOUNDS","matchedDisplay","screen","getDisplayMatching","x","y","LAST_DISPLAY","id","e","error","makeWindow","requestSingleInstanceLock","has","registerFileProtocol","mtdSchemeHandler","useFrame","SAFE_MODE","titleBarStyle","HIDDEN","DEFAULT","UPDATE_CHANNEL","useXY","undefined","defaultFontFamily","standard","serif","sansSerif","monospace","backgroundThrottling","contextIsolation","nodeIntegrationInSubFrames","webgl","plugins","title","frame","minWidth","backgroundColor","isInApplicationsFolder","showMessageBox","message","buttons","then","response","moveMe","moveToApplicationsFolder","_event","setInterval","initialize","enable","_moduleName","_","moduleName","code","desc","beep","__dirname","hide","webRequest","onHeadersReceived","urls","details","callback","foo","responseHeaders","onBeforeSendHeaders","_details","cancel","newGuest","catch","params","focus","newMenu","popup","showOpenDialog","filters","extensions","results","filePaths","readFile","load","JSON","parse","showSaveDialog","defaultPath","filePath","writeFile","window","getFocusedWindow","unmaximize","maximize","minimize","copy","cut","paste","delete","selectAll","undo","redo","arg","copyImageAt","fileType","match","fileName","savePath","showSaveDialogSync","createWriteStream","pipe","saveImageAs","inspectElement","showEmojiPanel","ses","defaultSession","clear","flushStorageData","clearCache","clearHostResolverCache","cookies","flushStore","clearStorageData","storages","quotas","host","port","ws","req","headers","origin","data","String","setFullScreen","getWebContents","autoUpdater","globalShortcut","nativeTheme","path","configFile","readFileSync","showMessageBoxSync","tryConfig","setFeedURL","autoUpdateInstallOnQuit","autoInstallOnAppQuit","autoDownload","checkForUpdates","blah","blah2","downloadUpdate","allowPrerelease","channel","initAutoUpdater","setAppUserModelId","template","menu","request","customLoginImage","myUrl","URL","getAppPath","hostname","pathname","role","submenu","setApplicationMenu","registerSchemesAsPrivileged","scheme","privileges","bypassCSP","secure","allowServiceWorkers","supportFetchAPI","corsEnabled","setAsDefaultProtocolClient","disableDevTools","register","disableZoom","loadDesktopConfigMain","isMinimized","restore","shouldUseInvertedColorScheme"],"sourceRoot":""}